{"ast":null,"code":"import _defineProperty from\"/Users/marcin/workspace/react/flask-react-app/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/marcin/workspace/react/flask-react-app/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/marcin/workspace/react/flask-react-app/client/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/marcin/workspace/react/flask-react-app/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/marcin/workspace/react/flask-react-app/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/Users/marcin/workspace/react/flask-react-app/client/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/marcin/workspace/react/flask-react-app/client/node_modules/@babel/runtime/helpers/esm/inherits\";import React from'react';import Header from\"./components/Header\";import Input from'./components/Input';import{Row,Col}from'react-bootstrap';import Login from'./components/Login';import Table from'./components/Table';import Chart from'./components/Chart';import Test_Plot_Dates from'./Test_Plot_Dates';import{capitalizeString}from\"./utils_dates/functions\";import Loader from\"react-loader-spinner\";import'bootstrap/dist/css/bootstrap.min.css';import{get_min_value,get_max_value}from'./utils_dates/functions';import'./styles/plot.css';import{appConfig}from'./config.js';var dimensions=appConfig.dimensions;var MA_Day_5=\"5 Day MA for \";var LOWER_BAND=\"Lower Band for \";var UPPER_BAND=\"Upper Band for \";var ratio=4.5;var App=/*#__PURE__*/function(_React$PureComponent){_inherits(App,_React$PureComponent);function App(props){var _this;_classCallCheck(this,App);_this=_possibleConstructorReturn(this,_getPrototypeOf(App).call(this,props));_this.fetchCallback=function(keywords,selected_state_name,selected_time_frame){_this.setState({displayResults:false});_this.fetchData(keywords,selected_state_name,selected_time_frame);};_this.updateWindowDimensions=_this.updateWindowDimensions.bind(_assertThisInitialized(_this));_this.state={username:\"user\",keywords:[],authenticated:true,displayResults:false,region_state:\"US\",selected_time_frame:\"today 5-y\",options:{title:\"Trends Forecast\",x_label:\"Date\",y_label:\"Search interest (%)\",dimensions:dimensions},historical_data:[],forecasted_data:[],rate_table_data:[],growth_table_data:[],x_trans:85,y_trans:85,fetching_results:false};_this.myRef=React.createRef();return _this;}_createClass(App,[{key:\"fetchData\",value:function fetchData(keywords,state,selected_time_frame){var _this2=this;// let url = appConfig.KEYWORDS_NEW;\nvar url=\"/new\";this.setState({fetching_results:true});fetch(url,{method:'POST',headers:{'Content-type':'application/json'},body:JSON.stringify({keywords:keywords,region_state:state,time_frame:selected_time_frame})}).then(function(res){return res.json();}).then(function(result){var _this2$setState;var width=_this2.myRef.current.offsetWidth;var height=width/ratio;var x_trans=_this2.state.x_trans;var y_trans=_this2.state.y_trans;var x_trans2=_this2.state.x_trans;var y_trans2=_this2.state.y_trans;if(width>1800){height=height;x_trans=80;y_trans=80;x_trans2=50;y_trans2=80;}if(width<=1800){height=1.2*width/ratio;x_trans=80;y_trans=80;x_trans2=50;y_trans2=80;}if(width<=1600){height=1.4*width/ratio;x_trans=80;y_trans=80;x_trans2=50;y_trans2=80;}if(width<=1400){height=1.6*width/ratio;x_trans=70;y_trans=70;x_trans2=50;y_trans2=70;}if(width<=1200){height=1.8*width/ratio;x_trans=60;y_trans=60;x_trans2=50;y_trans2=60;}// if(width<=800){\n//   height = (2.2)*width/(ratio);\n//   x_trans = 60;\n//   y_trans = 20;\n//   x_trans2 = 20;\n//   y_trans2 = 60;\n// }\nif(width<=700){height=4*width/ratio;x_trans=60;y_trans=20;x_trans2=50;y_trans2=keywords.length*14+80;}_this2.setState((_this2$setState={keywords:keywords,displayResults:true,region_state:state,selected_time_frame:selected_time_frame},_defineProperty(_this2$setState,\"displayResults\",true),_defineProperty(_this2$setState,\"historical_data\",_this2.get_historical_data(keywords,result)),_defineProperty(_this2$setState,\"forecasted_data\",_this2.get_forecasted_data(keywords,result)),_defineProperty(_this2$setState,\"rate_table_data\",_this2.getRateTableData(result.growth_rate_result)),_defineProperty(_this2$setState,\"growth_table_data\",_this2.getGrowthTableData(result.projected_growth_result)),_defineProperty(_this2$setState,\"div_height\",height),_defineProperty(_this2$setState,\"x_trans\",x_trans),_defineProperty(_this2$setState,\"y_trans\",y_trans),_defineProperty(_this2$setState,\"x_trans2\",x_trans2),_defineProperty(_this2$setState,\"y_trans2\",y_trans2),_defineProperty(_this2$setState,\"fetching_results\",false),_this2$setState));}).catch(function(error){console.log(\"error:\");this.setState({fetching_results:false});console.log(error);});}},{key:\"componentDidMount\",value:function componentDidMount(){this.updateWindowDimensions();window.addEventListener('resize',this.updateWindowDimensions);this.myRef.current.focus();}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){window.removeEventListener('resize',this.updateWindowDimensions);}},{key:\"updateWindowDimensions\",value:function updateWindowDimensions(){var width=this.myRef.current.offsetWidth;var height=width/ratio;var x_trans=this.state.x_trans;var y_trans=this.state.y_trans;var x_trans2=this.state.x_trans;var y_trans2=this.state.y_trans;if(width>1800){height=height;x_trans=80;y_trans=80;x_trans2=50;y_trans2=80;}if(width<=1800){height=1.2*width/ratio;x_trans=80;y_trans=80;x_trans2=50;y_trans2=80;}if(width<=1600){height=1.4*width/ratio;x_trans=80;y_trans=80;x_trans2=50;y_trans2=80;}if(width<=1400){height=1.6*width/ratio;x_trans=70;y_trans=70;x_trans2=50;y_trans2=70;}if(width<=1200){height=1.8*width/ratio;x_trans=60;y_trans=60;x_trans2=50;y_trans2=70;}// if(width<=800){\n//   height = (2.2)*width/(ratio);\n//   x_trans = 60;\n//   y_trans = 20;\n//   x_trans2 = 20;\n//   y_trans2 = 60;\n// }\nif(width<=700){height=4*width/ratio;x_trans=60;y_trans=20;x_trans2=50;y_trans2=this.state.keywords.length*14+80;}this.setState({div_height:height,x_trans:x_trans,y_trans:y_trans,x_trans2:x_trans2,y_trans2:y_trans2});}},{key:\"render\",value:function render(){var ranges={max_x:261+52+0,min_x:0,max_y:120,min_y:-10};if(this.state.displayResults){var min_y=get_min_value(this.state.historical_data);var max_y=get_max_value(this.state.historical_data);var lower_bound=Math.ceil((Math.abs(min_y)+1)/10)*10;var upper_bound=Math.ceil((Math.abs(max_y)+1)/10)*10;console.log(\"!!: \"+max_y);console.log(\"!!: \"+upper_bound);ranges={max_x:this.state.historical_data[0].length+this.state.forecasted_data[0].length,min_x:0,max_y:upper_bound,min_y:-lower_bound};// console.log(\"ranges\")\n// console.log(ranges)\n}if(this.state.authenticated){return React.createElement(\"div\",{ref:this.myRef},React.createElement(\"div\",{className:\"main_results\"},this.state.displayResults?React.createElement(\"div\",null,React.createElement(Header,{username:this.state.username}),React.createElement(Input,{callbackFromParent:this.fetchCallback}),React.createElement(\"div\",{className:\"results_div\"},React.createElement(\"div\",{className:\"map_div\"},React.createElement(Chart,{height:this.state.div_height})),React.createElement(\"div\",{id:\"plot_div\"},React.createElement(Test_Plot_Dates,{options:this.state.options,ranges:ranges,historical_data:this.state.historical_data,forecasted_data:this.state.forecasted_data,number_of_series:this.state.forecasted_data.length,keywords:this.state.keywords,height:this.state.div_height,x_trans:this.state.x_trans,y_trans:this.state.y_trans,x_trans2:this.state.x_trans2,y_trans2:this.state.y_trans2}))),React.createElement(\"div\",{className:\"tables\"},React.createElement(Row,null,React.createElement(\"div\",{className:\"table-responsive result_table\"},React.createElement(Table,{tableData:this.state.rate_table_data,title:\"Growth Rate\"})),React.createElement(\"div\",{className:\"table-responsive result_table\"},React.createElement(Table,{tableData:this.state.growth_table_data,title:\"Projected growth\"}))))):React.createElement(\"div\",null,React.createElement(Header,{username:this.state.username}),React.createElement(Input,{callbackFromParent:this.fetchCallback}),React.createElement(\"div\",{className:\"intro\"}),this.state.fetching_results?React.createElement(\"div\",{className:\"spinner\"},React.createElement(Loader,{type:\"Oval\",color:\"#007bff\",height:200,width:200,timeout:30000})):React.createElement(\"div\",null))));}else{return React.createElement(\"div\",{ref:this.myRef},React.createElement(Login,{callbackFromLogin:this.toLoginCallback}));}}},{key:\"getGrowthTableData\",value:function getGrowthTableData(data){var headers=[\"Projected growth in 5 weeks for US (for all keywords) [%]\",\"Projected growth in 5 weeks for US (for one keyword) [%]\"];var arr=Object.keys(data[\"Keyword\"]).map(function(key){return[capitalizeString(data[\"Keyword\"][key]),data[headers[0]][key],data[headers[1]][key]];});var result={data:arr,headers:headers};return result;}},{key:\"getRateTableData\",value:function getRateTableData(data){var headers=[\"Growth_Rate_0_1\",\"Growth_Rate_0_2\",\"Growth_Rate_0_3\",\"Growth_Rate_1_2\",\"Growth_Rate_2_3\"];var table_headers=[\"Growth Rate 1\",\"Growth Rate 2\",\"Growth Rate 3\",\"Growth Rate 4\",\"Growth Rate 5\"];var arr=Object.keys(data[\"Keyword\"]).map(function(key){return[capitalizeString(data[\"Keyword\"][key]),data[headers[0]][key],data[headers[1]][key],data[headers[2]][key],data[headers[3]][key],data[headers[4]][key]];});var result={data:arr,headers:table_headers};return result;}},{key:\"get_historical_data\",value:function get_historical_data(keywords,result){var data=[];// console.log(result)\nvar _loop=function _loop(keyword){var index=0;var k_w=keywords[keyword];// console.log(Object.keys(result[k_w][MA_Day_5+k_w]).length)\n// let arr = Object.keys(result[k_w][MA_Day_5+k_w]).slice(4,260).map(\nvar arr=Object.keys(result[k_w][MA_Day_5+k_w]).map(function(key){// console.log(result[k_w][UPPER_BAND+k_w][key])\nif(index<4){return[index++,Date.UTC(key.substring(0,4),key.substring(5,7)-1,key.substring(8,10)),result[k_w][k_w][key],result[k_w][LOWER_BAND+k_w][key],result[k_w][UPPER_BAND+k_w][key]];}else{return[index++,Date.UTC(key.substring(0,4),key.substring(5,7)-1,key.substring(8,10)),result[k_w][MA_Day_5+k_w][key],result[k_w][LOWER_BAND+k_w][key],result[k_w][UPPER_BAND+k_w][key]];}// return [index++, Date.UTC(key.substring(0,4), key.substring(5,7)-1, key.substring(8,10)-1), result[k_w][k_w][key], result[k_w][LOWER_BAND+k_w][key], result[k_w][UPPER_BAND+k_w][key]]\n// return [index++, Date.UTC(key.substring(0,4), key.substring(5,7)-1, key.substring(8,10)-1), result[k_w][MA_Day_5+k_w][key], result[k_w][LOWER_BAND+k_w][key], result[k_w][UPPER_BAND+k_w][key]]\n});data.push(arr);};for(var keyword in keywords){_loop(keyword);}return data;}},{key:\"get_forecasted_data\",value:function get_forecasted_data(keywords,result){var data=[];var _loop2=function _loop2(keyword){var index=0;var k_w=keywords[keyword];// console.log(Object.keys(result[keywords[keyword] + \"F\"][keywords[keyword]]).length)\nvar arr=Object.keys(result[keywords[keyword]+\"F\"][keywords[keyword]]).map(function(key){if(index<4){return[index++,Date.UTC(key.substring(0,4),key.substring(5,7)-1,key.substring(8,10)),result[keywords[keyword]+\"F\"][k_w][key],result[keywords[keyword]+\"F\"][LOWER_BAND+k_w][key],result[keywords[keyword]+\"F\"][UPPER_BAND+k_w][key]];}else{return[index++,Date.UTC(key.substring(0,4),key.substring(5,7)-1,key.substring(8,10)),result[keywords[keyword]+\"F\"][MA_Day_5+k_w][key],result[keywords[keyword]+\"F\"][LOWER_BAND+k_w][key],result[keywords[keyword]+\"F\"][UPPER_BAND+k_w][key]];}// return [index++, Date.UTC(key.substring(0,4), key.substring(5,7)-1, key.substring(8,10)), result[keywords[keyword] + \"F\"][k_w][key], result[keywords[keyword] + \"F\"][LOWER_BAND+k_w][key], result[keywords[keyword] + \"F\"][UPPER_BAND+k_w][key]]\n//return [index++, Date.UTC(key.substring(0,4), key.substring(5,7)-1, key.substring(8,10)-1), result[keywords[keyword] + \"F\"][k_w][key], result[keywords[keyword] + \"F\"][LOWER_BAND+k_w][key], result[keywords[keyword] + \"F\"][UPPER_BAND+k_w][key]]\n// return [index++, Date.UTC(key.substring(0,4), key.substring(5,7)-1, key.substring(8,10)-1), result[keywords[keyword] + \"F\"][MA_Day_5+k_w][key], result[keywords[keyword] + \"F\"][LOWER_BAND+k_w][key], result[keywords[keyword] + \"F\"][UPPER_BAND+k_w][key]]\n});data.push(arr);};for(var keyword in keywords){_loop2(keyword);}return data;}}]);return App;}(React.PureComponent);export default App;","map":{"version":3,"sources":["/Users/marcin/workspace/react/flask-react-app/client/src/App.js"],"names":["React","Header","Input","Row","Col","Login","Table","Chart","Test_Plot_Dates","capitalizeString","Loader","get_min_value","get_max_value","appConfig","dimensions","MA_Day_5","LOWER_BAND","UPPER_BAND","ratio","App","props","fetchCallback","keywords","selected_state_name","selected_time_frame","setState","displayResults","fetchData","updateWindowDimensions","bind","state","username","authenticated","region_state","options","title","x_label","y_label","historical_data","forecasted_data","rate_table_data","growth_table_data","x_trans","y_trans","fetching_results","myRef","createRef","url","fetch","method","headers","body","JSON","stringify","time_frame","then","res","json","result","width","current","offsetWidth","height","x_trans2","y_trans2","length","get_historical_data","get_forecasted_data","getRateTableData","growth_rate_result","getGrowthTableData","projected_growth_result","catch","error","console","log","window","addEventListener","focus","removeEventListener","div_height","ranges","max_x","min_x","max_y","min_y","lower_bound","Math","ceil","abs","upper_bound","toLoginCallback","data","arr","Object","keys","map","key","table_headers","keyword","index","k_w","Date","UTC","substring","push","PureComponent"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Header from \"./components/Header\"\nimport Input from './components/Input'\nimport { Row, Col } from 'react-bootstrap';\nimport Login from './components/Login';\nimport Table from './components/Table';\nimport Chart from './components/Chart';\nimport Test_Plot_Dates from './Test_Plot_Dates';\nimport { capitalizeString } from \"./utils_dates/functions\";\nimport Loader from \"react-loader-spinner\";\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nimport { get_min_value, get_max_value} from './utils_dates/functions'\nimport './styles/plot.css'\n\nimport { appConfig } from './config.js';\n\n\nlet dimensions = appConfig.dimensions;\n\nconst MA_Day_5 = \"5 Day MA for \";\nconst LOWER_BAND = \"Lower Band for \";\nconst UPPER_BAND = \"Upper Band for \";\n\nconst ratio = 4.5;\n\n\n\nclass App extends React.PureComponent {\n  \n    constructor(props){\n      super(props);\n      this.updateWindowDimensions = this.updateWindowDimensions.bind(this);\n\n      this.state = {\n        username: \"user\",\n        keywords: [],\n        authenticated: true,\n        displayResults: false,\n        region_state: \"US\",\n        selected_time_frame: \"today 5-y\",\n        options: {\n          title: \"Trends Forecast\",\n          x_label: \"Date\",\n          y_label: \"Search interest (%)\",\n          dimensions: dimensions,\n        },\n        historical_data: [],\n        forecasted_data: [],\n        rate_table_data: [],\n        growth_table_data: [],\n        x_trans: 85,\n        y_trans: 85,\n        fetching_results: false,\n      };\n\n      this.myRef = React.createRef();\n\n    }\n\n    fetchCallback = (keywords, selected_state_name, selected_time_frame) => {\n        this.setState({\n            displayResults: false,\n        });\n  \n        this.fetchData(keywords, selected_state_name, selected_time_frame)\n    }\n\n    fetchData(keywords, state, selected_time_frame){\n\n        // let url = appConfig.KEYWORDS_NEW;\n        let url = \"/new\"\n\n        this.setState({\n          fetching_results: true\n        })\n        \n        fetch(url, {\n          method: 'POST',\n          headers: {\n            'Content-type': 'application/json',\n          },\n          body: JSON.stringify({\n            keywords: keywords, region_state: state, time_frame: selected_time_frame\n          }),\n        }).then(res => res.json())\n            .then(\n            (result) => {\n\n              let width = this.myRef.current.offsetWidth;\n              let height = width/(ratio);\n              let x_trans = this.state.x_trans;\n              let y_trans = this.state.y_trans;\n\n              let x_trans2 = this.state.x_trans;\n              let y_trans2 = this.state.y_trans;\n\n              if(width>1800){\n                height = height;\n                x_trans = 80;\n                y_trans = 80;\n                x_trans2 = 50;\n                y_trans2 = 80;\n              }\n        \n              if(width<=1800){\n                height = (1.2)*width/(ratio);\n                x_trans = 80;\n                y_trans = 80;\n                x_trans2 = 50;\n                y_trans2 = 80;\n              }\n        \n              if(width<=1600){\n                height = (1.4)*width/(ratio);\n                x_trans = 80;\n                y_trans = 80;\n                x_trans2 = 50;\n                y_trans2 = 80;\n              }\n              \n              if(width<=1400){\n                height = (1.6)*width/(ratio);\n                x_trans = 70;\n                y_trans = 70;\n                x_trans2 = 50;\n                y_trans2 = 70;\n              }\n        \n              if(width<=1200){\n                height = (1.8)*width/(ratio);\n                x_trans = 60;\n                y_trans = 60;\n                x_trans2 = 50;\n                y_trans2 = 60;\n              }\n        \n              // if(width<=800){\n              //   height = (2.2)*width/(ratio);\n              //   x_trans = 60;\n              //   y_trans = 20;\n              //   x_trans2 = 20;\n              //   y_trans2 = 60;\n              // }\n        \n              if(width<=700){\n                height = (4)*width/(ratio);\n                x_trans = 60;\n                y_trans = 20;\n                x_trans2 = 50;\n                y_trans2 = keywords.length*14+ 80;\n              }\n        \n              this.setState({\n                  keywords: keywords,\n                  displayResults: true,\n                  region_state: state,\n                  selected_time_frame: selected_time_frame,\n                  displayResults: true,\n                  historical_data: this.get_historical_data(keywords, result),\n                  forecasted_data: this.get_forecasted_data(keywords, result),\n                  rate_table_data: this.getRateTableData(result.growth_rate_result),\n                  growth_table_data: this.getGrowthTableData(result.projected_growth_result),\n                  div_height: height,\n                  x_trans: x_trans,\n                  y_trans: y_trans,\n                  x_trans2: x_trans2,\n                  y_trans2: y_trans2,\n                  fetching_results: false\n              });\n            }).catch(function(error) {\n                 console.log(\"error:\")\n                 this.setState({\n                  fetching_results: false\n                });\n                 console.log(error)\n          })\n    }\n\n    componentDidMount() {\n      this.updateWindowDimensions();\n      window.addEventListener('resize', this.updateWindowDimensions);\n      this.myRef.current.focus();\n    }\n\n    componentWillUnmount() {\n      window.removeEventListener('resize', this.updateWindowDimensions);\n    }\n    \n    updateWindowDimensions() {\n      let width = this.myRef.current.offsetWidth;\n      let height = width/(ratio);\n      let x_trans = this.state.x_trans;\n      let y_trans = this.state.y_trans;\n      let x_trans2 = this.state.x_trans;\n      let y_trans2 = this.state.y_trans;\n\n      if(width>1800){\n        height = height;\n        x_trans = 80;\n        y_trans = 80;\n        x_trans2 = 50;\n        y_trans2 = 80;\n      }\n\n      if(width<=1800){\n        height = (1.2)*width/(ratio);\n        x_trans = 80;\n        y_trans = 80;\n        x_trans2 = 50;\n        y_trans2 = 80;\n      }\n\n      if(width<=1600){\n        height = (1.4)*width/(ratio);\n        x_trans = 80;\n        y_trans = 80;\n        x_trans2 = 50;\n        y_trans2 = 80;\n      }\n      \n      if(width<=1400){\n        height = (1.6)*width/(ratio);\n        x_trans = 70;\n        y_trans = 70;\n        x_trans2 = 50;\n        y_trans2 = 70;\n      }\n\n      if(width<=1200){\n        height = (1.8)*width/(ratio);\n        x_trans = 60;\n        y_trans = 60;\n        x_trans2 = 50;\n        y_trans2 = 70;\n      }\n\n      // if(width<=800){\n      //   height = (2.2)*width/(ratio);\n      //   x_trans = 60;\n      //   y_trans = 20;\n      //   x_trans2 = 20;\n      //   y_trans2 = 60;\n      // }\n\n      if(width<=700){\n        height = (4)*width/(ratio);\n        x_trans = 60;\n        y_trans = 20;\n        x_trans2 = 50;\n        y_trans2 = this.state.keywords.length*14 + 80;\n      }\n\n      this.setState({\n        div_height: height,\n        x_trans: x_trans,\n        y_trans: y_trans,\n        x_trans2: x_trans2,\n        y_trans2: y_trans2,\n      });\n    }\n\n    render() {\n\n      let ranges =  {\n        max_x: (261 + 52 + 0),\n        min_x: 0,\n        max_y: 120,\n        min_y: -10,\n      }\n\n        if(this.state.displayResults){\n\n          let min_y = get_min_value(this.state.historical_data);\n          let max_y = get_max_value(this.state.historical_data);\n\n          \n\n          let lower_bound = Math.ceil((Math.abs(min_y)+1) / 10) * 10\n          let upper_bound = Math.ceil((Math.abs(max_y)+1) / 10) * 10\n\n          console.log(\"!!: \" + max_y)\n\n          console.log(\"!!: \" + upper_bound)\n\n          ranges = {\n            max_x: (this.state.historical_data[0].length + this.state.forecasted_data[0].length),\n            min_x: 0,\n            max_y: upper_bound,\n            min_y: -lower_bound,\n          }\n\n          // console.log(\"ranges\")\n          // console.log(ranges)\n        }\n\n\n        if (this.state.authenticated) {\n\n        return (\n          <div ref={this.myRef}>\n            <div className=\"main_results\">\n            {this.state.displayResults ? (\n            \n            <div>\n              <Header username={this.state.username} />\n\n              <Input callbackFromParent={this.fetchCallback}/>\n\n              <div className=\"results_div\">\n                    <div className=\"map_div\">\n                      <Chart height={this.state.div_height} />\n                      {/* <Chart callbackFromApp={this.mapCallback}/> */}\n                    </div>\n                    <div id=\"plot_div\"> \n                        <Test_Plot_Dates options={this.state.options} ranges={ranges} historical_data={this.state.historical_data} forecasted_data={this.state.forecasted_data} number_of_series={this.state.forecasted_data.length} keywords={this.state.keywords} height={this.state.div_height} x_trans={this.state.x_trans} y_trans={this.state.y_trans} x_trans2={this.state.x_trans2} y_trans2={this.state.y_trans2} />\n                        {/* <Plot options={this.state.options} historical_data={this.state.historical_data} forecasted_data={this.state.forecasted_data} number_of_series={this.state.forecasted_data.length} keywords={this.state.keywords} /> */}\n                    </div>\n              </div>\n              <div className=\"tables\">\n                <Row>\n                    <div className=\"table-responsive result_table\">\n                        <Table tableData={this.state.rate_table_data} title={\"Growth Rate\"}/>\n                    </div>\n                    <div className=\"table-responsive result_table\">\n                        <Table tableData={this.state.growth_table_data} title={\"Projected growth\"} />\n                    </div>\n                </Row>\n              </div>\n            </div>  ) : (\n            \n            <div>\n              <Header username={this.state.username} />\n              <Input callbackFromParent={this.fetchCallback}/>\n\n              <div className=\"intro\">\n              </div>\n              {this.state.fetching_results ? (    \n                <div className=\"spinner\">\n                  <Loader type=\"Oval\" color=\"#007bff\" height={200} width={200} timeout={30000}/>\n                </div>   \n                ) : (<div></div>) }\n\n\n            </div>\n            )\n          }\n          </div>\n        </div>\n      );\n        } else{\n        return (\n        <div ref={this.myRef}>\n            <Login callbackFromLogin={this.toLoginCallback}/>\n            \n        </div>);      \n        }\n    }\n    \n      getGrowthTableData(data){\n        let headers = [\"Projected growth in 5 weeks for US (for all keywords) [%]\", \"Projected growth in 5 weeks for US (for one keyword) [%]\"]\n        \n        \n        let arr = Object.keys(data[\"Keyword\"]).map(\n          function(key){\n            return [capitalizeString(data[\"Keyword\"][key]), data[headers[0]][key], data[headers[1]][key]]\n          }\n        );\n    \n        let result = {\n          data: arr,\n          headers: headers\n        }\n    \n        return result;\n      }\n    \n      getRateTableData(data){\n        let headers = [\"Growth_Rate_0_1\", \"Growth_Rate_0_2\", \"Growth_Rate_0_3\", \"Growth_Rate_1_2\", \"Growth_Rate_2_3\"]\n        let table_headers = [\"Growth Rate 1\", \"Growth Rate 2\", \"Growth Rate 3\", \"Growth Rate 4\", \"Growth Rate 5\"]\n    \n        let arr = Object.keys(data[\"Keyword\"]).map(\n          function(key){\n            return [capitalizeString(data[\"Keyword\"][key]), data[headers[0]][key], data[headers[1]][key], data[headers[2]][key], data[headers[3]][key], data[headers[4]][key]]\n          }\n        );\n    \n        let result = {\n          data: arr,\n          headers: table_headers\n        }\n    \n        return result;\n      }\n\n      get_historical_data(keywords, result){\n        let data = []\n        // console.log(result)\n\n        for (let keyword in keywords) {  \n            let index = 0;\n\n            \n\n            let k_w = keywords[keyword]\n\n            \n\n            // console.log(Object.keys(result[k_w][MA_Day_5+k_w]).length)\n            // let arr = Object.keys(result[k_w][MA_Day_5+k_w]).slice(4,260).map(\n            let arr = Object.keys(result[k_w][MA_Day_5+k_w]).map(\n            function(key){\n              // console.log(result[k_w][UPPER_BAND+k_w][key])\n              if(index<4){\n                return [index++, Date.UTC(key.substring(0,4), key.substring(5,7)-1, key.substring(8,10)), result[k_w][k_w][key], result[k_w][LOWER_BAND+k_w][key], result[k_w][UPPER_BAND+k_w][key]]\n              }else{\n                return [index++, Date.UTC(key.substring(0,4), key.substring(5,7)-1, key.substring(8,10)), result[k_w][MA_Day_5+k_w][key], result[k_w][LOWER_BAND+k_w][key], result[k_w][UPPER_BAND+k_w][key]]\n              }\n              \n              // return [index++, Date.UTC(key.substring(0,4), key.substring(5,7)-1, key.substring(8,10)-1), result[k_w][k_w][key], result[k_w][LOWER_BAND+k_w][key], result[k_w][UPPER_BAND+k_w][key]]\n                // return [index++, Date.UTC(key.substring(0,4), key.substring(5,7)-1, key.substring(8,10)-1), result[k_w][MA_Day_5+k_w][key], result[k_w][LOWER_BAND+k_w][key], result[k_w][UPPER_BAND+k_w][key]]\n            }\n            );\n            data.push(arr)\n        }\n\n        return data;\n    }\n    \n    get_forecasted_data(keywords, result){\n    let data = []\n\n    for (let keyword in keywords) {  \n        let index = 0;\n        let k_w = keywords[keyword]\n\n        // console.log(Object.keys(result[keywords[keyword] + \"F\"][keywords[keyword]]).length)\n\n        let arr = Object.keys(result[keywords[keyword] + \"F\"][keywords[keyword]]).map(\n        function(key){\n\n          if(index<4){\n            return [index++, Date.UTC(key.substring(0,4), key.substring(5,7)-1, key.substring(8,10)), result[keywords[keyword] + \"F\"][k_w][key], result[keywords[keyword] + \"F\"][LOWER_BAND+k_w][key], result[keywords[keyword] + \"F\"][UPPER_BAND+k_w][key]]\n          }else{\n            return [index++, Date.UTC(key.substring(0,4), key.substring(5,7)-1, key.substring(8,10)), result[keywords[keyword] + \"F\"][MA_Day_5+k_w][key], result[keywords[keyword] + \"F\"][LOWER_BAND+k_w][key], result[keywords[keyword] + \"F\"][UPPER_BAND+k_w][key]]\n          }\n\n          // return [index++, Date.UTC(key.substring(0,4), key.substring(5,7)-1, key.substring(8,10)), result[keywords[keyword] + \"F\"][k_w][key], result[keywords[keyword] + \"F\"][LOWER_BAND+k_w][key], result[keywords[keyword] + \"F\"][UPPER_BAND+k_w][key]]\n          //return [index++, Date.UTC(key.substring(0,4), key.substring(5,7)-1, key.substring(8,10)-1), result[keywords[keyword] + \"F\"][k_w][key], result[keywords[keyword] + \"F\"][LOWER_BAND+k_w][key], result[keywords[keyword] + \"F\"][UPPER_BAND+k_w][key]]\n          // return [index++, Date.UTC(key.substring(0,4), key.substring(5,7)-1, key.substring(8,10)-1), result[keywords[keyword] + \"F\"][MA_Day_5+k_w][key], result[keywords[keyword] + \"F\"][LOWER_BAND+k_w][key], result[keywords[keyword] + \"F\"][UPPER_BAND+k_w][key]]\n        }\n        );\n        data.push(arr)\n    }\n\n    return data;\n    }\n}\n  \n  \nexport default App;\n"]},"metadata":{},"sourceType":"module"}