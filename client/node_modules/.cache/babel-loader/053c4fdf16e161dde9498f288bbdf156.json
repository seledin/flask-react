{"ast":null,"code":"import _defineProperty from\"/Users/marcin/workspace/react/flask-react-app/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/marcin/workspace/react/flask-react-app/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/marcin/workspace/react/flask-react-app/client/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/marcin/workspace/react/flask-react-app/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/marcin/workspace/react/flask-react-app/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/marcin/workspace/react/flask-react-app/client/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import Header from\"./components/Header\";import Input from'./components/Input';import Plot from'./components/Plot2';import{Row,Col}from'react-bootstrap';import Login from'./components/Login';import Table from'./components/Table';import Chart from'./components/Chart';// import Test_Plot from './Test_Plot';\nimport Test_Plot_Dates from'./Test_Plot_Dates';import'bootstrap/dist/css/bootstrap.min.css';import{appConfig}from'./config.js';import'./styles/plot.css';// function calculateMean(array) {\n//   return (array.reduce((acc, c) => acc + c[1], 0)/array.length).toFixed(2)\n// }\nvar dimensions=appConfig.dimensions;var ranges=appConfig.ranges_dates;// const MA_Day_5 = \"5 Day MA\";\n// const LOWER_BAND = \"Lower Band\";\n// const UPPER_BAND = \"Upper Band\";\nvar MA_Day_5=\"5 Day MA for \";var LOWER_BAND=\"Lower Band for \";var UPPER_BAND=\"Upper Band for \";var App=/*#__PURE__*/function(_React$Component){_inherits(App,_React$Component);function App(props){var _this;_classCallCheck(this,App);_this=_possibleConstructorReturn(this,_getPrototypeOf(App).call(this,props));_this.handleSearch2=function(){var url='/users/ping';fetch(url).then(function(response){return response.json();}).then(function(data){console.log(\"this data\");console.log(data);_this.setState({title:\"after\"});});};_this.fetchCallback=function(data){// console.log(data.keywords)\n// this.handleSearch3();\n// this.setState({\n//     displayResults: true,\n// });\n// this.fetchData2(data.keywords, data.selected_state_name, data.selected_time_frame)\n_this.setState({displayResults:false});_this.fetchData2(data.keywords,data.selected_state_name,data.selected_time_frame);// this.setState({\n//     displayResults: true,\n// });\n};_this.state={repos:[],title:\"before\",username:\"user\",keywords:[],authenticated:true,displayResults:false,region_state:\"US\",data:[],futureData:[],selected_time_frame:\"today 5-y\",dataRanges:[],futureDataRanges:[],rankRates:[],growthRates:[],options:{title:\"Trends Forecast\",x_label:\"Date\",y_label:\"Search interest (%)\",dimensions:dimensions}};//   this.state = {\n//     username: \"user\",\n//     keywords: [],\n//     authenticated: true,\n//     displayResults: false,\n//     region_state: \"US\",\n//     data: [],\n//     futureData: [],\n//     selected_time_frame: \"today 5-y\",\n//     dataRanges: [],\n//     futureDataRanges: [],\n//     rankRates: [],\n//     growthRates: [],\n//     options: {\n//       title: \"Trends Forecast\",\n//       x_label: \"Date\",\n//       y_label: \"Search interest (%)\",\n//       dimensions: dimensions,\n//     },\n//   };\nreturn _this;}_createClass(App,[{key:\"componentDidMount\",value:function componentDidMount(){// this.handleSearch2();\n}},{key:\"fetchData2\",value:function fetchData2(keywords,state,selected_time_frame){var _this2=this;// let url = appConfig.KEYWORDS_NEW;\nvar url=\"/new\";fetch(url,{method:'POST',headers:{'Content-type':'application/json'},body:JSON.stringify({keywords:keywords,region_state:state,time_frame:selected_time_frame})}).then(function(res){return res.json();}).then(function(result){var _that$setState;// console.log(\"$$$\")        \n// console.log(result)\nvar that=_this2;that.setState((_that$setState={data:_this2.dataMapping2(keywords,result),futureData:_this2.futureData2(keywords,result),//   dataRanges: this.dataMapping2(keywords, result)[1],\n//   futureDataRanges: this.futureData2(keywords, result)[1],\nkeywords:keywords,displayResults:true,region_state:state,selected_time_frame:selected_time_frame},_defineProperty(_that$setState,\"displayResults\",true),_defineProperty(_that$setState,\"rankRates\",_this2.getRateTableData(result.growth_rate_result)),_defineProperty(_that$setState,\"growthRates\",_this2.getGrowthTableData(result.projected_growth_result)),_that$setState));});}//     handleSearch = (user) =>{\n//       let url = 'https://api.github.com/users/'+user+'/repos';\n//    fetch(url).\n//     then(response => response.json()).then((repos) => {\n//         console.log(repos);\n//         console.log(repos.length);\n//         this.setState({\n//           repos: repos\n//         });\n//       });\n//     };\n},{key:\"render\",value:function render(){if(this.state.authenticated){return React.createElement(\"div\",{className:\"main_results\"},this.state.displayResults?React.createElement(\"div\",null,React.createElement(Header,{username:this.state.username}),React.createElement(Input,{callbackFromParent:this.fetchCallback}),React.createElement(\"div\",{className:\"results_div\"},React.createElement(Row,null,React.createElement(Col,{sm:5},React.createElement(\"div\",null,React.createElement(Chart,null))),React.createElement(Col,{sm:7},React.createElement(\"div\",null,React.createElement(Test_Plot_Dates,{options:this.state.options,data:this.state.data,futureData:this.state.futureData,number_of_series:this.state.futureData.length,keywords:this.state.keywords}))))),React.createElement(\"div\",{className:\"tables\"},React.createElement(Row,null,React.createElement(Col,{sm:6},React.createElement(\"span\",{className:\"center\"},React.createElement(\"h3\",null,\"Growth Rate\")),React.createElement(Table,{tableData:this.state.rankRates})),React.createElement(Col,{sm:6},React.createElement(\"span\",{className:\"center\"},React.createElement(\"h3\",null,\"Projected growth\")),React.createElement(Table,{tableData:this.state.growthRates}))))):React.createElement(\"div\",null,React.createElement(Header,{username:this.state.username}),React.createElement(Input,{callbackFromParent:this.fetchCallback}),React.createElement(\"div\",{className:\"intro\"})));}else{return React.createElement(\"div\",null,React.createElement(Login,{callbackFromLogin:this.toLoginCallback}));}}// getRankRates(){\n//     fetch(appConfig.GROWTH_RANKER_URL, {\n//       method: 'POST',\n//       headers: {\n//         'Content-type': 'application/json',\n//       },\n//       body: JSON.stringify({\n//         keywords: this.state.keywords\n//       }),\n//     }).then(res => res.json())\n//       .then(\n//       (result) => {\n//         return this.getRateTableData(result)\n//       },\n//       )\n//   }\n//   getGrowthRates(){\n//     fetch(appConfig.GROWTH_RANKER_URL, {\n//       method: 'POST',\n//       headers: {\n//         'Content-type': 'application/json',\n//       },\n//       body: JSON.stringify({\n//         keywords: this.state.keywords\n//       }),\n//     }).then(res => res.json())\n//       .then(\n//       (result) => {\n//         return this.getGrowthRates(result)\n//       },\n//       )\n//   }\n},{key:\"getGrowthTableData\",value:function getGrowthTableData(data){// console.log(data)\n// return data\nvar headers=[\"Projected growth in 5 weeks for US (for all keywords) [%]\",\"Projected growth in 5 weeks for US (for one keyword) [%]\"];var arr=Object.keys(data[\"Keyword\"]).map(function(key){return[data[\"Keyword\"][key],data[headers[0]][key],data[headers[1]][key]];});var result={data:arr,headers:headers};console.log(result);return result;}},{key:\"getRateTableData\",value:function getRateTableData(data){// console.log(data)\n// return data\nvar headers=[\"Growth_Rate_0_1\",\"Growth_Rate_0_2\",\"Growth_Rate_0_3\",\"Growth_Rate_1_2\",\"Growth_Rate_2_3\"];var arr=Object.keys(data[\"Keyword\"]).map(function(key){return[data[\"Keyword\"][key],data[headers[0]][key],data[headers[1]][key],data[headers[2]][key],data[headers[3]][key],data[headers[4]][key]];});var result={data:arr,headers:headers};return result;}},{key:\"dataMapping2\",value:function dataMapping2(keywords,result){var data=[];// let dataRange = []\n// console.log(\"ss\")\n// console.log(result)\nvar _loop=function _loop(keyword){// console.log(\"!!\" + keyword)\n// console.log(result[keywords[keyword]][MA_Day_5])\nvar index=0;var k_w=keywords[keyword];var arr=Object.keys(result[k_w][MA_Day_5+k_w]).slice(4,260).map(function(key){// return [Date.UTC(key.substring(0,4), key.substring(5,7), key.substring(8,10)), result[keywords[keyword]][MA_Day_5][key]]\nreturn[index++,Date.UTC(key.substring(0,4),key.substring(5,7),key.substring(8,10)),result[k_w][MA_Day_5+k_w][key],result[k_w][LOWER_BAND+k_w][key],result[k_w][UPPER_BAND+k_w][key]];});data.push(arr);};for(var keyword in keywords){_loop(keyword);}// for (let keyword in keywords) {  \n//   let arr = Object.keys(result[keywords[keyword]][LOWER_BAND]).slice(4,260).map(\n//     function(key){\n//       return [Date.UTC(key.substring(0,4), key.substring(5,7), key.substring(8,10)), result[keywords[keyword]][LOWER_BAND][key], result[keywords[keyword]][UPPER_BAND][key]]\n//     }\n//   );\n//   dataRange.push(arr)\n// }\n// .slice()\n// console.log(data)\n// console.log(JSON.stringify(data))\n// console.log(JSON.stringify(data.slice(4,254)))\nreturn data;}},{key:\"futureData2\",value:function futureData2(keywords,result){var data=[];// let dataRange = []\nvar _loop2=function _loop2(keyword){var index=0;var k_w=keywords[keyword];var arr=Object.keys(result[keywords[keyword]+\"F\"][keywords[keyword]]).map(function(key){// return [Date.UTC(key.substring(0,4), key.substring(5,7), key.substring(8,10)), result[keywords[keyword] + \"F\"][keywords[keyword]][key]]\nreturn[index++,Date.UTC(key.substring(0,4),key.substring(5,7),key.substring(8,10)),result[keywords[keyword]+\"F\"][MA_Day_5+k_w][key],result[keywords[keyword]+\"F\"][LOWER_BAND+k_w][key],result[keywords[keyword]+\"F\"][UPPER_BAND+k_w][key]];});data.push(arr);};for(var keyword in keywords){_loop2(keyword);}// for (let keyword in keywords) {  \n//   let arr = Object.keys(result[keywords[keyword] + \"F\"][LOWER_BAND]).map(\n//     function(key){\n//       return [Date.UTC(key.substring(0,4), key.substring(5,7), key.substring(8,10)), result[keywords[keyword] + \"F\"][LOWER_BAND][key], result[keywords[keyword] + \"F\"][UPPER_BAND][key]]\n//     }\n//   );\n//   dataRange.push(arr)\n// }\n// console.log(data)\n// console.log(JSON.stringify(data.slice(4,52)))\n// console.log(JSON.stringify(data))\nreturn data;}}]);return App;}(React.Component);export default App;","map":{"version":3,"sources":["/Users/marcin/workspace/react/flask-react-app/client/src/App.js"],"names":["React","Component","Header","Input","Plot","Row","Col","Login","Table","Chart","Test_Plot_Dates","appConfig","dimensions","ranges","ranges_dates","MA_Day_5","LOWER_BAND","UPPER_BAND","App","props","handleSearch2","url","fetch","then","response","json","data","console","log","setState","title","fetchCallback","displayResults","fetchData2","keywords","selected_state_name","selected_time_frame","state","repos","username","authenticated","region_state","futureData","dataRanges","futureDataRanges","rankRates","growthRates","options","x_label","y_label","method","headers","body","JSON","stringify","time_frame","res","result","that","dataMapping2","futureData2","getRateTableData","growth_rate_result","getGrowthTableData","projected_growth_result","length","toLoginCallback","arr","Object","keys","map","key","keyword","index","k_w","slice","Date","UTC","substring","push"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport Header from \"./components/Header\"\nimport Input from './components/Input'\nimport Plot  from './components/Plot2'\nimport { Row,Col } from 'react-bootstrap';\nimport Login from './components/Login';\nimport Table from './components/Table';\nimport Chart from './components/Chart';\n// import Test_Plot from './Test_Plot';\nimport Test_Plot_Dates from './Test_Plot_Dates';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport { appConfig } from './config.js';\nimport './styles/plot.css'\n\n\n// function calculateMean(array) {\n//   return (array.reduce((acc, c) => acc + c[1], 0)/array.length).toFixed(2)\n// }\nlet dimensions = appConfig.dimensions;\nlet ranges = appConfig.ranges_dates;\n\n// const MA_Day_5 = \"5 Day MA\";\n// const LOWER_BAND = \"Lower Band\";\n// const UPPER_BAND = \"Upper Band\";\n\nconst MA_Day_5 = \"5 Day MA for \";\nconst LOWER_BAND = \"Lower Band for \";\nconst UPPER_BAND = \"Upper Band for \";\n\n\n\nclass App extends React.Component {\n  \n    constructor(props){\n      super(props);\n      this.state = {\n        repos: [],\n        title: \"before\",\n        username: \"user\",\n        keywords: [],\n        authenticated: true,\n        displayResults: false,\n        region_state: \"US\",\n        data: [],\n        futureData: [],\n        selected_time_frame: \"today 5-y\",\n        dataRanges: [],\n        futureDataRanges: [],\n        rankRates: [],\n        growthRates: [],\n        options: {\n          title: \"Trends Forecast\",\n          x_label: \"Date\",\n          y_label: \"Search interest (%)\",\n          dimensions: dimensions,\n        },\n      };\n\n    //   this.state = {\n    //     username: \"user\",\n    //     keywords: [],\n    //     authenticated: true,\n    //     displayResults: false,\n    //     region_state: \"US\",\n    //     data: [],\n    //     futureData: [],\n    //     selected_time_frame: \"today 5-y\",\n    //     dataRanges: [],\n    //     futureDataRanges: [],\n    //     rankRates: [],\n    //     growthRates: [],\n    //     options: {\n    //       title: \"Trends Forecast\",\n    //       x_label: \"Date\",\n    //       y_label: \"Search interest (%)\",\n    //       dimensions: dimensions,\n    //     },\n    //   };\n    }\n\n    componentDidMount(){\n        // this.handleSearch2();\n    }\n\n    handleSearch2 = () => {\n        let url = '/users/ping';\n        fetch(url).\n        then(response => response.json()).then((data) => {\n        console.log(\"this data\")  \n        console.log(data);\n            this.setState({\n            title: \"after\"\n            });\n        });\n    };\n\n\n    fetchCallback = (data) => {\n\n        // console.log(data.keywords)\n\n        // this.handleSearch3();\n        // this.setState({\n        //     displayResults: true,\n        // });\n    // this.fetchData2(data.keywords, data.selected_state_name, data.selected_time_frame)\n\n        this.setState({\n            displayResults: false,\n        });\n  \n        this.fetchData2(data.keywords, data.selected_state_name, data.selected_time_frame)\n        // this.setState({\n        //     displayResults: true,\n        // });\n  \n\n\n    }\n\n    fetchData2(keywords, state, selected_time_frame){\n\n        // let url = appConfig.KEYWORDS_NEW;\n        let url = \"/new\"\n        \n        fetch(url, {\n          method: 'POST',\n          headers: {\n            'Content-type': 'application/json',\n          },\n          body: JSON.stringify({\n            keywords: keywords, region_state: state, time_frame: selected_time_frame\n          }),\n        }).then(res => res.json())\n              .then(\n                (result) => {\n    \n            // console.log(\"$$$\")        \n            // console.log(result)\n            var that = this;\n    \n            that.setState({\n              data: this.dataMapping2(keywords, result),\n              futureData: this.futureData2(keywords, result),\n            //   dataRanges: this.dataMapping2(keywords, result)[1],\n            //   futureDataRanges: this.futureData2(keywords, result)[1],\n              keywords: keywords,\n              displayResults: true,\n              region_state: state,\n              selected_time_frame: selected_time_frame,\n              displayResults: true,\n              rankRates: this.getRateTableData(result.growth_rate_result),\n              growthRates: this.getGrowthTableData(result.projected_growth_result)\n            });\n                })\n          \n      }\n    \n//     handleSearch = (user) =>{\n//       let url = 'https://api.github.com/users/'+user+'/repos';\n//    fetch(url).\n//     then(response => response.json()).then((repos) => {\n//         console.log(repos);\n//         console.log(repos.length);\n//         this.setState({\n//           repos: repos\n//         });\n//       });\n//     };\n    \n    render() {\n\n        if (this.state.authenticated) {\n        return (\n            <div className=\"main_results\">\n            {this.state.displayResults ? (\n            \n            <div>\n              <Header username={this.state.username} />\n\n              <Input callbackFromParent={this.fetchCallback}/>\n\n              <div className=\"results_div\">\n              <Row> \n                  <Col sm={5}>\n                    <div>\n                      <Chart />\n                      {/* <Chart callbackFromApp={this.mapCallback}/> */}\n                    </div>\n                  </Col>\n                  <Col sm={7}>\n                    <div> \n                      {/* <Test_Plot_Dates options={this.state.options} number_of_series={5}/> */}\n                      <Test_Plot_Dates options={this.state.options} data={this.state.data} futureData={this.state.futureData} number_of_series={this.state.futureData.length} keywords={this.state.keywords} />\n                    </div>\n                  </Col>\n              </Row> \n              </div>\n              <div className=\"tables\">\n                <Row>\n                  <Col sm={6}>\n                    <span className=\"center\"><h3>Growth Rate</h3></span>\n                    {/* <Table /> */}\n                    <Table tableData={this.state.rankRates} />\n                  </Col>\n                  <Col sm={6}>\n                    <span className=\"center\"><h3>Projected growth</h3></span>\n                    <Table tableData={this.state.growthRates}  />\n                    {/* <Table /> */}\n                  </Col>\n                </Row>\n              </div>\n\n            </div>  ) : (\n            \n            <div>\n              <Header username={this.state.username} />\n              <Input callbackFromParent={this.fetchCallback}/>\n\n              <div className=\"intro\">\n              </div>\n            </div>\n            )\n          }\n            </div>\n            );\n        } else{\n        return (\n        <div>\n            <Login callbackFromLogin={this.toLoginCallback}/>\n        </div>);      \n        }\n    }\n    \n\n    // getRankRates(){\n    //     fetch(appConfig.GROWTH_RANKER_URL, {\n    //       method: 'POST',\n    //       headers: {\n    //         'Content-type': 'application/json',\n    //       },\n    //       body: JSON.stringify({\n    //         keywords: this.state.keywords\n    //       }),\n    //     }).then(res => res.json())\n    //       .then(\n    //       (result) => {\n    //         return this.getRateTableData(result)\n    //       },\n    //       )\n    //   }\n    \n    //   getGrowthRates(){\n    //     fetch(appConfig.GROWTH_RANKER_URL, {\n    //       method: 'POST',\n    //       headers: {\n    //         'Content-type': 'application/json',\n    //       },\n    //       body: JSON.stringify({\n    //         keywords: this.state.keywords\n    //       }),\n    //     }).then(res => res.json())\n    //       .then(\n    //       (result) => {\n    //         return this.getGrowthRates(result)\n    //       },\n    //       )\n    //   }\n\n\n      getGrowthTableData(data){\n        // console.log(data)\n        // return data\n        let headers = [\"Projected growth in 5 weeks for US (for all keywords) [%]\", \"Projected growth in 5 weeks for US (for one keyword) [%]\"]\n        \n        \n        let arr = Object.keys(data[\"Keyword\"]).map(\n          function(key){\n            return [data[\"Keyword\"][key], data[headers[0]][key], data[headers[1]][key]]\n          }\n        );\n    \n        let result = {\n          data: arr,\n          headers: headers\n        }\n\n        console.log(result)\n    \n        return result;\n      }\n    \n      getRateTableData(data){\n        // console.log(data)\n        // return data\n        let headers = [\"Growth_Rate_0_1\", \"Growth_Rate_0_2\", \"Growth_Rate_0_3\", \"Growth_Rate_1_2\", \"Growth_Rate_2_3\"]\n    \n        let arr = Object.keys(data[\"Keyword\"]).map(\n          function(key){\n            return [data[\"Keyword\"][key], data[headers[0]][key], data[headers[1]][key], data[headers[2]][key], data[headers[3]][key], data[headers[4]][key]]\n          }\n        );\n    \n        let result = {\n          data: arr,\n          headers: headers\n        }\n    \n        return result;\n      }\n\n\n      dataMapping2(keywords, result){\n        let data = []\n        // let dataRange = []\n    \n        // console.log(\"ss\")\n        // console.log(result)\n    \n        for (let keyword in keywords) {  \n            // console.log(\"!!\" + keyword)\n            // console.log(result[keywords[keyword]][MA_Day_5])\n            let index = 0;\n            let k_w = keywords[keyword]\n            let arr = Object.keys(result[k_w][MA_Day_5+k_w]).slice(4,260).map(\n            function(key){\n              // return [Date.UTC(key.substring(0,4), key.substring(5,7), key.substring(8,10)), result[keywords[keyword]][MA_Day_5][key]]\n              return [index++, Date.UTC(key.substring(0,4), key.substring(5,7), key.substring(8,10)), result[k_w][MA_Day_5+k_w][key], result[k_w][LOWER_BAND+k_w][key], result[k_w][UPPER_BAND+k_w][key]]\n            }\n          );\n          data.push(arr)\n        }\n    \n        // for (let keyword in keywords) {  \n        //   let arr = Object.keys(result[keywords[keyword]][LOWER_BAND]).slice(4,260).map(\n        //     function(key){\n        //       return [Date.UTC(key.substring(0,4), key.substring(5,7), key.substring(8,10)), result[keywords[keyword]][LOWER_BAND][key], result[keywords[keyword]][UPPER_BAND][key]]\n        //     }\n        //   );\n        //   dataRange.push(arr)\n        // }\n    // .slice()\n        // console.log(data)\n        // console.log(JSON.stringify(data))\n        // console.log(JSON.stringify(data.slice(4,254)))\n    \n        return data;\n      }\n    \n    \n      futureData2(keywords, result){\n    \n        let data = []\n        // let dataRange = []\n    \n        for (let keyword in keywords) {  \n          let index = 0;\n          let k_w = keywords[keyword]\n          let arr = Object.keys(result[keywords[keyword] + \"F\"][keywords[keyword]]).map(\n            function(key){\n              // return [Date.UTC(key.substring(0,4), key.substring(5,7), key.substring(8,10)), result[keywords[keyword] + \"F\"][keywords[keyword]][key]]\n              return [index++, Date.UTC(key.substring(0,4), key.substring(5,7), key.substring(8,10)), result[keywords[keyword] + \"F\"][MA_Day_5+k_w][key], result[keywords[keyword] + \"F\"][LOWER_BAND+k_w][key], result[keywords[keyword] + \"F\"][UPPER_BAND+k_w][key]]\n            }\n          );\n          data.push(arr)\n        }\n    \n        // for (let keyword in keywords) {  \n        //   let arr = Object.keys(result[keywords[keyword] + \"F\"][LOWER_BAND]).map(\n        //     function(key){\n        //       return [Date.UTC(key.substring(0,4), key.substring(5,7), key.substring(8,10)), result[keywords[keyword] + \"F\"][LOWER_BAND][key], result[keywords[keyword] + \"F\"][UPPER_BAND][key]]\n        //     }\n        //   );\n        //   dataRange.push(arr)\n        // }\n    \n        // console.log(data)\n    \n        // console.log(JSON.stringify(data.slice(4,52)))\n        // console.log(JSON.stringify(data))\n    \n        return data;\n      }\n  }\n  \n  \n  export default App;\n"]},"metadata":{},"sourceType":"module"}