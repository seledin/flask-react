{"ast":null,"code":"import _defineProperty from\"/Users/marcin/workspace/react/flask-react-app/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/marcin/workspace/react/flask-react-app/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/marcin/workspace/react/flask-react-app/client/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/marcin/workspace/react/flask-react-app/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/marcin/workspace/react/flask-react-app/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/Users/marcin/workspace/react/flask-react-app/client/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/marcin/workspace/react/flask-react-app/client/node_modules/@babel/runtime/helpers/esm/inherits\";import React from'react';import Header from\"./components/Header\";import Input from'./components/Input';import Login from'./components/Login';import Table from'./components/Table';import Chart from'./components/Chart';import KeywordPlot from'./components/plot';import{get_min_value,get_max_value}from'./components/plot/src/plot/parts/functions';import{appConfig}from'./config.js';import{capitalizeString}from'./components/plot/src/plot/parts/functions';import Loader from\"react-loader-spinner\";import'bootstrap/dist/css/bootstrap.min.css';import'./styles/styles.css';var dimensions=appConfig.dimensions;var MA_Day_5=\"5 Day MA for \";var LOWER_BAND=\"Lower Band for \";var UPPER_BAND=\"Upper Band for \";var HEADERS_GROWTH_RATES=[\"Growth_Rate_0_1\",\"Growth_Rate_0_2\",\"Growth_Rate_0_3\",\"Growth_Rate_1_2\",\"Growth_Rate_2_3\"];var HEADERS_PROJECTED_GROWTH=[\"Projected growth in 5 weeks for US (for all keywords) [%]\",\"Projected growth in 5 weeks for US (for one keyword) [%]\"];var ratio=4.5;var SECONDS_NUMBER=60;var App=/*#__PURE__*/function(_React$PureComponent){_inherits(App,_React$PureComponent);function App(props){var _this;_classCallCheck(this,App);_this=_possibleConstructorReturn(this,_getPrototypeOf(App).call(this,props));_this.fetchCallback=function(keywords,selected_state_name,selected_time_frame){_this.setState({displayResults:false});_this.fetchData(keywords,selected_state_name,selected_time_frame);};_this.mapCallback=function(state){console.log(\"state \"+state);_this.setState({displayResults:false});_this.fetchData(_this.state.keywords,state,_this.state.selected_time_frame);};_this.toLoginCallback=function(){console.log(\"! \"+_this.state.seconds);_this.timer=0;_this.setState({authenticated:true,seconds:SECONDS_NUMBER});// if(this.state.authenticated) {\n// this.startTimer();\n// }\n};_this.handleMouseMove=function(){_this.timer=0;_this.setState({seconds:SECONDS_NUMBER});// console.log(\"mouse moving\")\n};_this.updateWindowDimensions=_this.updateWindowDimensions.bind(_assertThisInitialized(_this));_this.handleMouseMove=_this.handleMouseMove.bind(_assertThisInitialized(_this));_this.handleHoverOff=_this.handleHoverOff.bind(_assertThisInitialized(_this));_this.timer=0;_this.startTimer=_this.startTimer.bind(_assertThisInitialized(_this));_this.countDown=_this.countDown.bind(_assertThisInitialized(_this));_this.state={username:\"user\",authenticated:false,displayResults:false,options:{// title: \"Trends Forecast\",\n// x_label: \"Date\",\n// y_label: \"Search interest (%)\",\ndimensions:dimensions},region_state:\"US\",selected_time_frame:\"today 5-y\",keywords:[],data:[],rate_table_data:[],growth_table_data:[],fetching_results:false,x_trans:85,y_trans:85,time:{},seconds:SECONDS_NUMBER};_this.myRef=React.createRef();// this.startTimer();\nreturn _this;}_createClass(App,[{key:\"fetchData\",value:function fetchData(keywords,state,selected_time_frame){var _this2=this;// let url = appConfig.KEYWORDS_NEW;\n// let url = appConfig.DATA_URL;\n// let url = \"/api\"\nvar url=\"/data\";this.setState({fetching_results:true,keywords:keywords});// console.log(\"state \" + state)\nfetch(url,{method:'POST',headers:{'Content-type':'application/json'},body:JSON.stringify({keywords:keywords,region_state:state,time_frame:selected_time_frame})}).then(function(res){return res.json();}).then(function(result){var _this2$setState;var width=_this2.myRef.current.offsetWidth;var sizes=_this2.get_dimensions(width);_this2.setState((_this2$setState={keywords:keywords,displayResults:true,region_state:state,selected_time_frame:selected_time_frame},_defineProperty(_this2$setState,\"displayResults\",true),_defineProperty(_this2$setState,\"data\",_this2.get_data(keywords,result)),_defineProperty(_this2$setState,\"div_height\",sizes.height),_defineProperty(_this2$setState,\"x_trans\",sizes.x_trans_left),_defineProperty(_this2$setState,\"y_trans\",sizes.y_trans_up),_defineProperty(_this2$setState,\"x_trans_right\",sizes.x_trans_right),_defineProperty(_this2$setState,\"y_trans_bottom\",sizes.y_trans_bottom),_defineProperty(_this2$setState,\"fetching_results\",false),_this2$setState));}).catch(function(error){});}},{key:\"componentDidMount\",value:function componentDidMount(){this.updateWindowDimensions();window.addEventListener('resize',this.updateWindowDimensions);this.myRef.current.focus();var timeLeftVar=this.secondsToTime(this.state.seconds);this.setState({time:timeLeftVar});// this.countDown();\n// if(this.state.authenticated) {\n//   this.startTimer();\n// }\n}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){window.removeEventListener('resize',this.updateWindowDimensions);if(!this.state.authenticated){this.setState({seconds:SECONDS_NUMBER});}}},{key:\"startTimer\",value:function startTimer(){if(this.state.seconds===0){this.setState({authenticated:false,seconds:SECONDS_NUMBER});}console.log(this.timer);if(this.timer==0&&this.state.seconds>0){this.timer=setInterval(this.countDown,1000);}}},{key:\"secondsToTime\",value:function secondsToTime(secs){var hours=Math.floor(secs/(60*60));var divisor_for_minutes=secs%(60*60);var minutes=Math.floor(divisor_for_minutes/60);var divisor_for_seconds=divisor_for_minutes%60;var seconds=Math.ceil(divisor_for_seconds);var obj={\"h\":hours,\"m\":minutes,\"s\":seconds};return obj;}},{key:\"countDown\",value:function countDown(){// Remove one second, set state so a re-render happens.\nvar seconds=this.state.seconds-1;this.setState({time:this.secondsToTime(seconds),seconds:seconds});// Check if we're at zero.\nif(seconds==0){clearInterval(this.timer);this.setState({authenticated:false,seconds:SECONDS_NUMBER});}}},{key:\"updateWindowDimensions\",value:function updateWindowDimensions(){var width=this.myRef.current.offsetWidth;var sizes=this.get_dimensions(width);this.setState({div_height:sizes.height,x_trans:sizes.x_trans_left,y_trans:sizes.y_trans_up,x_trans_right:sizes.x_trans_right,y_trans_bottom:sizes.y_trans_bottom});}},{key:\"handleHoverOff\",value:function handleHoverOff(event){// console.log(\"mouse leaving\")\n}},{key:\"render\",value:function render(){var ranges={max_x:261+52+0,min_x:0,max_y:120,min_y:-10};var plot_settings={title:\"Trends Forecast\",x_label:\"Date\",y_label:\"Search interest (%)\",// number_of_series: this.state.data.forecasted_data.length,\nnumber_of_series:this.state.keywords.length,keywords:this.state.keywords,height:this.state.div_height,x_trans_left:this.state.x_trans,y_trans_up:this.state.y_trans,x_trans_right:this.state.x_trans_right,y_trans_bottom:this.state.y_trans_bottom,ranges:ranges};if(this.state.displayResults){var min_y=get_min_value(this.state.data.historical_data);var max_y=get_max_value(this.state.data.historical_data);var lower_bound=(Math.ceil((min_y+1)/10)-1)*10;var upper_bound=Math.ceil((Math.abs(max_y)+1)/10)*10;ranges={max_x:this.state.data.historical_data[0].length+this.state.data.forecasted_data[0].length,min_x:0,max_y:upper_bound,min_y:lower_bound};plot_settings.ranges={max_x:this.state.data.historical_data[0].length+this.state.data.forecasted_data[0].length,min_x:0,max_y:upper_bound,min_y:lower_bound};}if(this.state.authenticated){return React.createElement(\"div\",{ref:this.myRef,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleHoverOff},React.createElement(\"div\",{className:\"main_results\"},this.state.displayResults?React.createElement(\"div\",null,React.createElement(Header,{username:this.state.username}),React.createElement(Input,{callbackFromParent:this.fetchCallback}),React.createElement(\"div\",{className:\"results_div\"},React.createElement(\"div\",{className:\"map_div\"},React.createElement(Chart,{callbackFromApp:this.mapCallback,height:this.state.div_height})),React.createElement(\"div\",{id:\"plot_div\"},React.createElement(KeywordPlot,{plot_settings:plot_settings,data:this.state.data}))),React.createElement(\"div\",{className:\"tables\"},React.createElement(\"div\",{className:\"row\"}),React.createElement(\"div\",{className:\"row\"}))):React.createElement(\"div\",null,React.createElement(Header,{username:this.state.username}),React.createElement(Input,{callbackFromParent:this.fetchCallback}),React.createElement(\"div\",{className:\"intro\"}),this.state.fetching_results?React.createElement(\"div\",{className:\"spinner\"},React.createElement(Loader,{type:\"Oval\",color:\"#007bff\",height:200,width:200,timeout:30000})):React.createElement(\"div\",null))));}else{return React.createElement(\"div\",{ref:this.myRef,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleHoverOff},React.createElement(Login,{callbackFromLogin:this.toLoginCallback}));}}},{key:\"getGrowthTableData\",value:function getGrowthTableData(data){var headers=HEADERS_PROJECTED_GROWTH;var arr=Object.keys(data[\"Keyword\"]).map(function(key){return[capitalizeString(data[\"Keyword\"][key]),data[headers[0]][key],data[headers[1]][key]];});var result={data:arr,headers:headers};return result;}},{key:\"getRateTableData\",value:function getRateTableData(data){var headers=HEADERS_GROWTH_RATES;var table_headers=[\"Growth Rate 1\",\"Growth Rate 2\",\"Growth Rate 3\",\"Growth Rate 4\",\"Growth Rate 5\"];var arr=Object.keys(data[\"Keyword\"]).map(function(key){return[capitalizeString(data[\"Keyword\"][key]),data[headers[0]][key],data[headers[1]][key],data[headers[2]][key],data[headers[3]][key],data[headers[4]][key]];});var result={data:arr,headers:table_headers};return result;}},{key:\"get_data\",value:function get_data(keywords,result){var historical_data=[];var forecasted_data=[];console.log(result);var _loop=function _loop(keyword){var index=0;var k_w=keywords[keyword];console.log(result[k_w].length);// let arr = Object.keys(result[k_w][MA_Day_5+k_w]).map(\nvar arr=Object.keys(result[k_w]).map(function(key){if(index<4){// return [index++, new Date(key).valueOf(), result[k_w][k_w][key], result[k_w][LOWER_BAND+k_w][key], result[k_w][UPPER_BAND+k_w][key]]\n// return [index++, new Date(key).valueOf(), 50, 40, 60]\nreturn[index++,new Date(key).valueOf(),result[k_w][key],result[LOWER_BAND+k_w][key],result[UPPER_BAND+k_w][key]];}else{// return [index++, new Date(key).valueOf(), result[k_w][MA_Day_5+k_w][key], result[k_w][LOWER_BAND+k_w][key], result[k_w][UPPER_BAND+k_w][key]]\nreturn[index++,new Date(key).valueOf(),result[k_w][key],result[LOWER_BAND+k_w][key],result[UPPER_BAND+k_w][key]];// return [index++, new Date(key).valueOf(), 50, 40, 60]\n}});historical_data.push(arr);arr=Object.keys(result[keywords[keyword]+\"F\"]).map(// arr = Object.keys(result[keywords[keyword] + \"F\"][keywords[keyword]]).map(\nfunction(key){if(index<4){// return [index++, new Date(key).valueOf(), result[keywords[keyword] + \"F\"][k_w][key], result[keywords[keyword] + \"F\"][LOWER_BAND+k_w][key], result[keywords[keyword] + \"F\"][UPPER_BAND+k_w][key]]            \n// return [index++, new Date(key).valueOf(), result[keywords[keyword] + \"F\"][k_w][key], result[keywords[keyword] + \"F\"][LOWER_BAND+k_w][key], result[keywords[keyword] + \"F\"][UPPER_BAND+k_w][key]]            \n// return [index++, new Date(key).valueOf(), 50, 40, 60]\nreturn[index++,new Date(key).valueOf(),result[k_w+\"F\"][key],result[LOWER_BAND+k_w+\"F\"][key],result[UPPER_BAND+k_w+\"F\"][key]];}else{// return [index++, new Date(key).valueOf(), result[keywords[keyword] + \"F\"][MA_Day_5+k_w][key], result[keywords[keyword] + \"F\"][LOWER_BAND+k_w][key], result[keywords[keyword] + \"F\"][UPPER_BAND+k_w][key]]\n// return [index++, new Date(key).valueOf(), 50, 40, 60]\nreturn[index++,new Date(key).valueOf(),result[k_w+\"F\"][key],result[LOWER_BAND+k_w+\"F\"][key],result[UPPER_BAND+k_w+\"F\"][key]];}});forecasted_data.push(arr);};for(var keyword in keywords){_loop(keyword);}return{historical_data:historical_data,forecasted_data:forecasted_data};}},{key:\"get_dimensions\",value:function get_dimensions(width){var height=width/ratio;var x_trans_left=this.state.x_trans;var y_trans_up=this.state.y_trans;var x_trans_right=this.state.x_trans;var y_trans_bottom=this.state.y_trans;if(width>1800){height=height;x_trans_left=80;y_trans_up=80;x_trans_right=50;y_trans_bottom=80;}if(width<=1800){height=1.2*width/ratio;x_trans_left=80;y_trans_up=80;x_trans_right=50;y_trans_bottom=80;}if(width<=1600){height=1.4*width/ratio;x_trans_left=80;y_trans_up=80;x_trans_right=50;y_trans_bottom=80;}if(width<=1400){height=1.6*width/ratio;x_trans_left=70;y_trans_up=70;x_trans_right=50;y_trans_bottom=70;}if(width<=1200){height=1.8*width/ratio;x_trans_left=60;y_trans_up=60;x_trans_right=50;y_trans_bottom=70;}// if(width<=800){\n//   height = (2.2)*width/(ratio);\n//   x_trans = 60;\n//   y_trans = 20;\n//   x_trans2 = 20;\n//   y_trans2 = 60;\n// }\nif(width<=700){height=4*width/ratio;x_trans_left=60;y_trans_up=20;x_trans_right=50;y_trans_bottom=this.state.keywords.length*14+80;}var sizes={height:height,x_trans_left:x_trans_left,y_trans_up:y_trans_up,x_trans_right:x_trans_right,y_trans_bottom:y_trans_bottom};return sizes;}}]);return App;}(React.PureComponent);export default App;","map":{"version":3,"sources":["/Users/marcin/workspace/react/flask-react-app/client/src/App.js"],"names":["React","Header","Input","Login","Table","Chart","KeywordPlot","get_min_value","get_max_value","appConfig","capitalizeString","Loader","dimensions","MA_Day_5","LOWER_BAND","UPPER_BAND","HEADERS_GROWTH_RATES","HEADERS_PROJECTED_GROWTH","ratio","SECONDS_NUMBER","App","props","fetchCallback","keywords","selected_state_name","selected_time_frame","setState","displayResults","fetchData","mapCallback","state","console","log","toLoginCallback","seconds","timer","authenticated","handleMouseMove","updateWindowDimensions","bind","handleHoverOff","startTimer","countDown","username","options","region_state","data","rate_table_data","growth_table_data","fetching_results","x_trans","y_trans","time","myRef","createRef","url","fetch","method","headers","body","JSON","stringify","time_frame","then","res","json","result","width","current","offsetWidth","sizes","get_dimensions","get_data","height","x_trans_left","y_trans_up","x_trans_right","y_trans_bottom","catch","error","window","addEventListener","focus","timeLeftVar","secondsToTime","removeEventListener","setInterval","secs","hours","Math","floor","divisor_for_minutes","minutes","divisor_for_seconds","ceil","obj","clearInterval","div_height","event","ranges","max_x","min_x","max_y","min_y","plot_settings","title","x_label","y_label","number_of_series","length","historical_data","lower_bound","upper_bound","abs","forecasted_data","arr","Object","keys","map","key","table_headers","keyword","index","k_w","Date","valueOf","push","PureComponent"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Header from \"./components/Header\"\nimport Input from './components/Input'\nimport Login from './components/Login';\nimport Table from './components/Table';\nimport Chart from './components/Chart';\nimport KeywordPlot from './components/plot';\nimport { get_min_value, get_max_value} from './components/plot/src/plot/parts/functions';\nimport { appConfig } from './config.js';\nimport { capitalizeString } from './components/plot/src/plot/parts/functions';\n\nimport Loader from \"react-loader-spinner\";\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './styles/styles.css';\n\nlet dimensions = appConfig.dimensions;\n\nconst MA_Day_5 = \"5 Day MA for \";\nconst LOWER_BAND = \"Lower Band for \";\nconst UPPER_BAND = \"Upper Band for \";\n\nconst HEADERS_GROWTH_RATES = [\"Growth_Rate_0_1\", \"Growth_Rate_0_2\", \"Growth_Rate_0_3\", \"Growth_Rate_1_2\", \"Growth_Rate_2_3\"];\nconst HEADERS_PROJECTED_GROWTH = [\"Projected growth in 5 weeks for US (for all keywords) [%]\", \"Projected growth in 5 weeks for US (for one keyword) [%]\"];\nconst ratio = 4.5;\n\nconst SECONDS_NUMBER = 60;\n\nclass App extends React.PureComponent {\n  \n    constructor(props){\n      super(props);\n      this.updateWindowDimensions = this.updateWindowDimensions.bind(this);\n      this.handleMouseMove = this.handleMouseMove.bind(this);\n      this.handleHoverOff = this.handleHoverOff.bind(this);\n\n      this.timer = 0;\n      this.startTimer = this.startTimer.bind(this);\n      this.countDown = this.countDown.bind(this);\n\n      this.state = {\n        username: \"user\",\n        authenticated: false,\n        displayResults: false,\n        options: {\n          // title: \"Trends Forecast\",\n          // x_label: \"Date\",\n          // y_label: \"Search interest (%)\",\n          dimensions: dimensions,\n        },\n        region_state: \"US\",\n        selected_time_frame: \"today 5-y\",\n        keywords: [],\n        data: [],\n        rate_table_data: [],\n        growth_table_data: [],\n        fetching_results: false,\n        x_trans: 85,\n        y_trans: 85,\n        time: {},\n        seconds: SECONDS_NUMBER,\n      };\n\n      this.myRef = React.createRef();\n      // this.startTimer();\n    }\n\n    fetchCallback = (keywords, selected_state_name, selected_time_frame) => {\n      this.setState({\n          displayResults: false,\n      });\n\n      this.fetchData(keywords, selected_state_name, selected_time_frame)\n    }\n\n    mapCallback = (state) => {\n      console.log(\"state \" + state)\n\n      this.setState({\n        displayResults: false,\n      });\n\n      this.fetchData(this.state.keywords, state, this.state.selected_time_frame)\n    }\n\n    fetchData(keywords, state, selected_time_frame){\n\n      // let url = appConfig.KEYWORDS_NEW;\n      // let url = appConfig.DATA_URL;\n      // let url = \"/api\"\n      let url = \"/data\"\n\n      this.setState({\n        fetching_results: true,\n        keywords: keywords\n      })\n\n      // console.log(\"state \" + state)\n      \n      fetch(url, {\n        method: 'POST',\n        headers: {\n          'Content-type':'application/json',\n        },\n        body: JSON.stringify({\n          keywords: keywords, region_state: state, time_frame: selected_time_frame\n        }),\n      }).then(res => res.json())\n        .then(\n        (result) => {\n          let width = this.myRef.current.offsetWidth;\n          let sizes = this.get_dimensions(width);\n    \n          this.setState({\n            keywords: keywords,\n            displayResults: true,\n            region_state: state,\n            selected_time_frame: selected_time_frame,\n            displayResults: true,\n            data: this.get_data(keywords, result),\n            // rate_table_data: this.getRateTableData(result.growth_rate_result),\n            // growth_table_data: this.getGrowthTableData(result.projected_growth_result),\n            div_height: sizes.height,\n            x_trans: sizes.x_trans_left,\n            y_trans: sizes.y_trans_up,\n            x_trans_right: sizes.x_trans_right,\n            y_trans_bottom: sizes.y_trans_bottom,\n            fetching_results: false\n          });\n        }).catch(function(error) {\n        \n        })\n      }\n\n    componentDidMount() {\n      this.updateWindowDimensions();\n      window.addEventListener('resize', this.updateWindowDimensions);\n      this.myRef.current.focus();\n\n      let timeLeftVar = this.secondsToTime(this.state.seconds);\n      this.setState({ time: timeLeftVar });\n\n      // this.countDown();\n      // if(this.state.authenticated) {\n      //   this.startTimer();\n      // }\n    }\n\n    componentWillUnmount() {\n      window.removeEventListener('resize', this.updateWindowDimensions);\n      if(!this.state.authenticated) {\n        this.setState({\n          seconds: SECONDS_NUMBER,\n        })\n      }\n    }\n\n    startTimer() {\n      if(this.state.seconds === 0){\n        this.setState({\n          authenticated: false,\n          seconds: SECONDS_NUMBER,\n        })\n      }\n      console.log(this.timer)\n      if (this.timer == 0 && this.state.seconds > 0) {\n        this.timer = setInterval(this.countDown, 1000);\n      }\n    }\n\n    secondsToTime(secs){\n      let hours = Math.floor(secs / (60 * 60));\n  \n      let divisor_for_minutes = secs % (60 * 60);\n      let minutes = Math.floor(divisor_for_minutes / 60);\n  \n      let divisor_for_seconds = divisor_for_minutes % 60;\n      let seconds = Math.ceil(divisor_for_seconds);\n  \n      let obj = {\n        \"h\": hours,\n        \"m\": minutes,\n        \"s\": seconds\n      };\n      return obj;\n    }\n\n    countDown() {\n      // Remove one second, set state so a re-render happens.\n      let seconds = this.state.seconds - 1;\n      this.setState({\n        time: this.secondsToTime(seconds),\n        seconds: seconds,\n      });\n      \n      // Check if we're at zero.\n      if (seconds == 0) { \n        clearInterval(this.timer);\n        this.setState({\n          authenticated: false,\n          seconds: SECONDS_NUMBER,\n        })\n      }\n    }\n    \n    updateWindowDimensions() {\n      let width = this.myRef.current.offsetWidth;\n      let sizes = this.get_dimensions(width);\n\n      this.setState({\n        div_height: sizes.height,\n        x_trans: sizes.x_trans_left,\n        y_trans: sizes.y_trans_up,\n        x_trans_right: sizes.x_trans_right,\n        y_trans_bottom: sizes.y_trans_bottom,\n      });\n    }\n\n    toLoginCallback =() => {\n      console.log(\"! \" + this.state.seconds)\n      this.timer=0;\n      this.setState({\n        authenticated: true,\n        seconds: SECONDS_NUMBER,\n        \n      });\n      // if(this.state.authenticated) {\n        // this.startTimer();\n      // }\n    }\n\n    // onDragEndCircle = () => {\n    handleMouseMove= () => {\n      this.timer = 0;\n      this.setState({\n        seconds: SECONDS_NUMBER,\n      });\n      // console.log(\"mouse moving\")\n    }\n\n    handleHoverOff(event) {\n      // console.log(\"mouse leaving\")\n    }\n\n\n\n    render() {\n\n      let ranges =  {\n        max_x: (261 + 52 + 0),\n        min_x: 0,\n        max_y: 120,\n        min_y: -10,\n      }\n\n      let plot_settings = {\n        title: \"Trends Forecast\",\n        x_label: \"Date\",\n        y_label: \"Search interest (%)\",\n        // number_of_series: this.state.data.forecasted_data.length,\n        number_of_series: this.state.keywords.length,\n        keywords: this.state.keywords,\n\n        height: this.state.div_height,\n        x_trans_left: this.state.x_trans,\n        y_trans_up: this.state.y_trans,\n        x_trans_right: this.state.x_trans_right,\n        y_trans_bottom: this.state.y_trans_bottom,\n\n        ranges: ranges\n      }\n\n      if(this.state.displayResults) {\n        let min_y = get_min_value(this.state.data.historical_data);\n        let max_y = get_max_value(this.state.data.historical_data);\n\n        let lower_bound = (Math.ceil(((min_y)+1) / 10)-1) * 10\n        let upper_bound = Math.ceil((Math.abs(max_y)+1) / 10) * 10\n\n        ranges = {\n          max_x: (this.state.data.historical_data[0].length + this.state.data.forecasted_data[0].length),\n          min_x: 0,\n          max_y: upper_bound,\n          min_y: lower_bound,\n        }\n\n        plot_settings.ranges = {\n          max_x: (this.state.data.historical_data[0].length + this.state.data.forecasted_data[0].length),\n          min_x: 0,\n          max_y: upper_bound,\n          min_y: lower_bound,\n        }\n      }\n\n      if (this.state.authenticated) {\n        return (\n          <div ref={this.myRef} onMouseMove={this.handleMouseMove} onMouseLeave={this.handleHoverOff}>\n            {/* <div>\n              <button onClick={this.startTimer}>Start</button> m: {this.state.time.m} s: {this.state.time.s}\n            </div> */}\n            \n            <div className=\"main_results\">\n\n            {/* {this.state.keywords.length<=5 ? (<div>\n\n              \n\n            </div>) : (<div>Too many keywords</div>)\n              \n            } */}\n\n            { (this.state.displayResults) ? (\n            \n            <div>\n              <Header username={this.state.username} />\n\n              <Input callbackFromParent={this.fetchCallback}/>\n\n              <div className=\"results_div\">\n                <div className=\"map_div\">\n                  <Chart callbackFromApp={this.mapCallback} height={this.state.div_height} />\n                </div>\n                <div id=\"plot_div\"> \n                  <KeywordPlot plot_settings={plot_settings} data={this.state.data} />\n                </div>\n              </div>\n              <div className=\"tables\">\n                <div className=\"row\">\n                  {/* <div className=\"table-responsive result_table\">\n                    <Table tableData={this.state.rate_table_data} title={\"Growth Rate\"}/>\n                  </div>\n                  <div className=\"table-responsive result_table\">\n                    <Table tableData={this.state.growth_table_data} title={\"Projected growth\"} />\n                  </div> */}\n                </div>\n                <div className=\"row\">\n                  {/* <Row> */}\n                    {/* <KeywordPlot height={500} width={500} radius={50} color={\"red\"} /> */}\n                    {/* <KeywordPlot options={this.state.options} ranges={ranges} historical_data={this.state.historical_data} forecasted_data={this.state.forecasted_data} number_of_series={this.state.forecasted_data.length} keywords={this.state.keywords} height={this.state.div_height} x_trans={this.state.x_trans} y_trans={this.state.y_trans} x_trans2={this.state.x_trans2} y_trans2={this.state.y_trans2} /> */}\n                  {/* </Row> */}\n                </div>\n              </div>\n            </div>  ) : (\n            \n            <div>\n              <Header username={this.state.username} />\n              <Input callbackFromParent={this.fetchCallback} />\n\n              <div className=\"intro\">\n\n              </div>\n\n              {this.state.fetching_results ? (    \n                <div className=\"spinner\">\n                  <Loader type=\"Oval\" color=\"#007bff\" height={200} width={200} timeout={30000} />\n                </div>   \n                ) : (<div></div>) }\n            </div>\n            )\n          }\n          </div>\n        </div>\n      );\n      } else {\n        return (\n          <div ref={this.myRef} onMouseMove={this.handleMouseMove} onMouseLeave={this.handleHoverOff}>\n            <Login callbackFromLogin={this.toLoginCallback} />\n          </div>\n        );      \n      }\n    }\n    \n    getGrowthTableData(data) {\n      let headers = HEADERS_PROJECTED_GROWTH;\n      \n      let arr = Object.keys(data[\"Keyword\"]).map(\n        function(key){\n          return [capitalizeString(data[\"Keyword\"][key]), data[headers[0]][key], data[headers[1]][key]]\n        }\n      );\n  \n      let result = {\n        data: arr,\n        headers: headers\n      }\n  \n      return result;\n    }\n    \n    getRateTableData(data) {\n      let headers = HEADERS_GROWTH_RATES;\n      let table_headers = [\"Growth Rate 1\", \"Growth Rate 2\", \"Growth Rate 3\", \"Growth Rate 4\", \"Growth Rate 5\"]\n  \n      let arr = Object.keys(data[\"Keyword\"]).map(\n        function(key){\n          return [capitalizeString(data[\"Keyword\"][key]), data[headers[0]][key], data[headers[1]][key], data[headers[2]][key], data[headers[3]][key], data[headers[4]][key]]\n        }\n      );\n  \n      let result = {\n        data: arr,\n        headers: table_headers\n      }\n  \n      return result;\n    }\n\n    get_data(keywords, result) {\n      let historical_data = []\n      let forecasted_data = []\n      console.log(result)\n\n      for (let keyword in keywords) {  \n        \n        let index = 0;\n        let k_w = keywords[keyword]\n        console.log(result[k_w].length)\n\n        // let arr = Object.keys(result[k_w][MA_Day_5+k_w]).map(\n        let arr = Object.keys(result[k_w]).map(\n          function(key){\n            if(index<4) {\n              // return [index++, new Date(key).valueOf(), result[k_w][k_w][key], result[k_w][LOWER_BAND+k_w][key], result[k_w][UPPER_BAND+k_w][key]]\n              // return [index++, new Date(key).valueOf(), 50, 40, 60]\n              return [index++, new Date(key).valueOf(), result[k_w][key], result[LOWER_BAND + k_w][key], result[UPPER_BAND+k_w][key]]\n            } else {\n              // return [index++, new Date(key).valueOf(), result[k_w][MA_Day_5+k_w][key], result[k_w][LOWER_BAND+k_w][key], result[k_w][UPPER_BAND+k_w][key]]\n              return [index++, new Date(key).valueOf(), result[k_w][key], result[LOWER_BAND + k_w][key], result[UPPER_BAND+k_w][key]]\n              // return [index++, new Date(key).valueOf(), 50, 40, 60]\n            }\n          }\n        );\n\n        historical_data.push(arr)\n\n        arr = Object.keys(result[keywords[keyword] + \"F\"]).map(\n        // arr = Object.keys(result[keywords[keyword] + \"F\"][keywords[keyword]]).map(\n          function(key){\n            if(index<4) {\n              // return [index++, new Date(key).valueOf(), result[keywords[keyword] + \"F\"][k_w][key], result[keywords[keyword] + \"F\"][LOWER_BAND+k_w][key], result[keywords[keyword] + \"F\"][UPPER_BAND+k_w][key]]            \n              // return [index++, new Date(key).valueOf(), result[keywords[keyword] + \"F\"][k_w][key], result[keywords[keyword] + \"F\"][LOWER_BAND+k_w][key], result[keywords[keyword] + \"F\"][UPPER_BAND+k_w][key]]            \n              // return [index++, new Date(key).valueOf(), 50, 40, 60]\n              return [index++, new Date(key).valueOf(), result[k_w + \"F\"][key], result[LOWER_BAND + k_w+ \"F\"][key], result[UPPER_BAND+k_w+ \"F\"][key]]\n            } else {\n              // return [index++, new Date(key).valueOf(), result[keywords[keyword] + \"F\"][MA_Day_5+k_w][key], result[keywords[keyword] + \"F\"][LOWER_BAND+k_w][key], result[keywords[keyword] + \"F\"][UPPER_BAND+k_w][key]]\n              // return [index++, new Date(key).valueOf(), 50, 40, 60]\n              return [index++, new Date(key).valueOf(), result[k_w + \"F\"][key], result[LOWER_BAND + k_w+ \"F\"][key], result[UPPER_BAND+k_w+ \"F\"][key]]\n            }\n          }\n        );\n        forecasted_data.push(arr)\n      }\n\n\n      return {\n        historical_data: historical_data,\n        forecasted_data: forecasted_data\n      }\n    }\n\n  get_dimensions(width) {\n    let height = width/(ratio);\n    let x_trans_left = this.state.x_trans;\n    let y_trans_up = this.state.y_trans;\n    let x_trans_right = this.state.x_trans;\n    let y_trans_bottom = this.state.y_trans;\n\n    if(width>1800) {\n      height = height;\n      x_trans_left = 80;\n      y_trans_up = 80;\n      x_trans_right = 50;\n      y_trans_bottom = 80;\n    }\n\n    if(width<=1800) {\n      height = (1.2)*width/(ratio);\n      x_trans_left = 80;\n      y_trans_up = 80;\n      x_trans_right = 50;\n      y_trans_bottom = 80;\n    }\n\n    if(width<=1600) {\n      height = (1.4)*width/(ratio);\n      x_trans_left = 80;\n      y_trans_up = 80;\n      x_trans_right = 50;\n      y_trans_bottom = 80;\n    }\n    \n    if(width<=1400) {\n      height = (1.6)*width/(ratio);\n      x_trans_left = 70;\n      y_trans_up = 70;\n      x_trans_right = 50;\n      y_trans_bottom = 70;\n    }\n\n    if(width<=1200) {\n      height = (1.8)*width/(ratio);\n      x_trans_left = 60;\n      y_trans_up = 60;\n      x_trans_right = 50;\n      y_trans_bottom = 70;\n    }\n\n    // if(width<=800){\n    //   height = (2.2)*width/(ratio);\n    //   x_trans = 60;\n    //   y_trans = 20;\n    //   x_trans2 = 20;\n    //   y_trans2 = 60;\n    // }\n\n    if(width<=700) {\n      height = (4)*width/(ratio);\n      x_trans_left = 60;\n      y_trans_up = 20;\n      x_trans_right = 50;\n      y_trans_bottom = this.state.keywords.length*14 + 80;\n    }\n\n    let sizes = {\n      height: height,\n      x_trans_left: x_trans_left,\n      y_trans_up: y_trans_up,\n      x_trans_right: x_trans_right,\n      y_trans_bottom: y_trans_bottom\n    }\n\n    return sizes;\n  }\n}\n  \n  \nexport default App;\n"]},"metadata":{},"sourceType":"module"}