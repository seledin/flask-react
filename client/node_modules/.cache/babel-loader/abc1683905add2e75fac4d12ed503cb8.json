{"ast":null,"code":"var _jsxFileName = \"/Users/marcin/workspace/react/flask-react-app/client/src/App.js\";\nimport React, { Component } from 'react';\nimport Header from \"./components/Header\";\nimport Input from './components/Input';\nimport Plot from './components/Plot2';\nimport { Row, Col } from 'react-bootstrap';\nimport Login from './components/Login';\nimport Table from './components/Table';\nimport Chart from './components/Chart'; // import Test_Plot from './Test_Plot';\n\nimport Test_Plot_Dates from './Test_Plot_Dates';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport { appConfig } from './config.js';\nimport './styles/plot.css'; // function calculateMean(array) {\n//   return (array.reduce((acc, c) => acc + c[1], 0)/array.length).toFixed(2)\n// }\n\nlet dimensions = appConfig.dimensions;\nlet ranges = appConfig.ranges_dates; // const MA_Day_5 = \"5 Day MA\";\n// const LOWER_BAND = \"Lower Band\";\n// const UPPER_BAND = \"Upper Band\";\n\nconst MA_Day_5 = \"5 Day MA for \";\nconst LOWER_BAND = \"Lower Band for \";\nconst UPPER_BAND = \"Upper Band for \";\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.handleSearch2 = () => {\n      let url = '/users/ping';\n      fetch(url).then(response => response.json()).then(data => {\n        console.log(\"this data\");\n        console.log(data);\n        this.setState({\n          title: \"after\"\n        });\n      });\n    };\n\n    this.fetchCallback = data => {\n      // console.log(data.keywords)\n      // this.handleSearch3();\n      // this.setState({\n      //     displayResults: true,\n      // });\n      // this.fetchData2(data.keywords, data.selected_state_name, data.selected_time_frame)\n      this.setState({\n        displayResults: false\n      });\n      this.fetchData2(data.keywords, data.selected_state_name, data.selected_time_frame); // this.setState({\n      //     displayResults: true,\n      // });\n    };\n\n    this.state = {\n      repos: [],\n      title: \"before\",\n      username: \"user\",\n      keywords: [],\n      authenticated: true,\n      displayResults: false,\n      region_state: \"US\",\n      data: [],\n      futureData: [],\n      selected_time_frame: \"today 5-y\",\n      dataRanges: [],\n      futureDataRanges: [],\n      rankRates: [],\n      growthRates: [],\n      options: {\n        title: \"Trends Forecast\",\n        x_label: \"Date\",\n        y_label: \"Search interest (%)\",\n        dimensions: dimensions\n      }\n    }; //   this.state = {\n    //     username: \"user\",\n    //     keywords: [],\n    //     authenticated: true,\n    //     displayResults: false,\n    //     region_state: \"US\",\n    //     data: [],\n    //     futureData: [],\n    //     selected_time_frame: \"today 5-y\",\n    //     dataRanges: [],\n    //     futureDataRanges: [],\n    //     rankRates: [],\n    //     growthRates: [],\n    //     options: {\n    //       title: \"Trends Forecast\",\n    //       x_label: \"Date\",\n    //       y_label: \"Search interest (%)\",\n    //       dimensions: dimensions,\n    //     },\n    //   };\n  }\n\n  componentDidMount() {// this.handleSearch2();\n  }\n\n  fetchData2(keywords, state, selected_time_frame) {\n    // let url = appConfig.KEYWORDS_NEW;\n    let url = \"/new\";\n    fetch(url, {\n      method: 'POST',\n      headers: {\n        'Content-type': 'application/json'\n      },\n      body: JSON.stringify({\n        keywords: keywords,\n        region_state: state,\n        time_frame: selected_time_frame\n      })\n    }).then(res => res.json()).then(result => {\n      // console.log(\"$$$\")        \n      // console.log(result)\n      var that = this;\n      that.setState({\n        data: this.dataMapping2(keywords, result),\n        futureData: this.futureData2(keywords, result),\n        //   dataRanges: this.dataMapping2(keywords, result)[1],\n        //   futureDataRanges: this.futureData2(keywords, result)[1],\n        keywords: keywords,\n        displayResults: true,\n        region_state: state,\n        selected_time_frame: selected_time_frame,\n        displayResults: true,\n        //   rankRates: this.getRateTableData(result.rateranker),\n        growthRates: this.getGrowthTableData(result.projected_growth_result)\n      });\n    });\n  } //     handleSearch = (user) =>{\n  //       let url = 'https://api.github.com/users/'+user+'/repos';\n  //    fetch(url).\n  //     then(response => response.json()).then((repos) => {\n  //         console.log(repos);\n  //         console.log(repos.length);\n  //         this.setState({\n  //           repos: repos\n  //         });\n  //       });\n  //     };\n\n\n  render() {\n    if (this.state.authenticated) {\n      return React.createElement(\"div\", {\n        className: \"main_results\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175\n        },\n        __self: this\n      }, this.state.displayResults ? React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }, React.createElement(Header, {\n        username: this.state.username,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      }), React.createElement(Input, {\n        callbackFromParent: this.fetchCallback,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"results_div\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }, React.createElement(Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }, React.createElement(Col, {\n        sm: 5,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      }, React.createElement(Chart, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187\n        },\n        __self: this\n      }))), React.createElement(Col, {\n        sm: 7,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192\n        },\n        __self: this\n      }, React.createElement(Test_Plot_Dates, {\n        options: this.state.options,\n        data: this.state.data,\n        futureData: this.state.futureData,\n        number_of_series: this.state.futureData.length,\n        keywords: this.state.keywords,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      }))))), React.createElement(\"div\", {\n        className: \"tables\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }, React.createElement(Row, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }, React.createElement(Col, {\n        sm: 6,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      }, \"Growth Rate\"))), React.createElement(Col, {\n        sm: 6,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 207\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 207\n        },\n        __self: this\n      }, \"Projected growth\")), React.createElement(Table, {\n        tableData: this.state.growthRates,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208\n        },\n        __self: this\n      }))))) : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216\n        },\n        __self: this\n      }, React.createElement(Header, {\n        username: this.state.username,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217\n        },\n        __self: this\n      }), React.createElement(Input, {\n        callbackFromParent: this.fetchCallback,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 218\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"intro\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220\n        },\n        __self: this\n      })));\n    } else {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 229\n        },\n        __self: this\n      }, React.createElement(Login, {\n        callbackFromLogin: this.toLoginCallback,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 230\n        },\n        __self: this\n      }));\n    }\n  } // getRankRates(){\n  //     fetch(appConfig.GROWTH_RANKER_URL, {\n  //       method: 'POST',\n  //       headers: {\n  //         'Content-type': 'application/json',\n  //       },\n  //       body: JSON.stringify({\n  //         keywords: this.state.keywords\n  //       }),\n  //     }).then(res => res.json())\n  //       .then(\n  //       (result) => {\n  //         return this.getRateTableData(result)\n  //       },\n  //       )\n  //   }\n  //   getGrowthRates(){\n  //     fetch(appConfig.GROWTH_RANKER_URL, {\n  //       method: 'POST',\n  //       headers: {\n  //         'Content-type': 'application/json',\n  //       },\n  //       body: JSON.stringify({\n  //         keywords: this.state.keywords\n  //       }),\n  //     }).then(res => res.json())\n  //       .then(\n  //       (result) => {\n  //         return this.getGrowthRates(result)\n  //       },\n  //       )\n  //   }\n\n\n  getGrowthTableData(data) {\n    let headers = [\"Projected growth in 5 weeks for US (for all keywords) [%]\", \"Projected growth in 5 weeks for US (for one keyword) [%]\"];\n    let arr = Object.keys(data[\"Keyword\"]).map(function (key) {\n      return [data[\"Keyword\"][key], data[headers[0]][key], data[headers[1]][key]];\n    });\n    let result = {\n      data: arr,\n      headers: headers\n    };\n    console.log(result);\n    return result;\n  } //   getRateTableData(data){\n  //     let headers = [\"Growth_Rate_0_1\", \"Growth_Rate_0_2\", \"Growth_Rate_0_3\", \"Growth_Rate_1_2\", \"Growth_Rate_2_3\"]\n  //     let arr = Object.keys(data[\"Keyword\"]).map(\n  //       function(key){\n  //         return [data[\"Keyword\"][key], data[headers[0]][key], data[headers[1]][key], data[headers[2]][key], data[headers[3]][key], data[headers[4]][key]]\n  //       }\n  //     );\n  //     let result = {\n  //       data: arr,\n  //       headers: headers\n  //     }\n  //     return result;\n  //   }\n\n\n  dataMapping2(keywords, result) {\n    let data = []; // let dataRange = []\n    // console.log(\"ss\")\n    // console.log(result)\n\n    for (let keyword in keywords) {\n      // console.log(\"!!\" + keyword)\n      // console.log(result[keywords[keyword]][MA_Day_5])\n      let index = 0;\n      let k_w = keywords[keyword];\n      let arr = Object.keys(result[k_w][MA_Day_5 + k_w]).slice(4, 260).map(function (key) {\n        // return [Date.UTC(key.substring(0,4), key.substring(5,7), key.substring(8,10)), result[keywords[keyword]][MA_Day_5][key]]\n        return [index++, Date.UTC(key.substring(0, 4), key.substring(5, 7), key.substring(8, 10)), result[k_w][MA_Day_5 + k_w][key], result[k_w][LOWER_BAND + k_w][key], result[k_w][UPPER_BAND + k_w][key]];\n      });\n      data.push(arr);\n    } // for (let keyword in keywords) {  \n    //   let arr = Object.keys(result[keywords[keyword]][LOWER_BAND]).slice(4,260).map(\n    //     function(key){\n    //       return [Date.UTC(key.substring(0,4), key.substring(5,7), key.substring(8,10)), result[keywords[keyword]][LOWER_BAND][key], result[keywords[keyword]][UPPER_BAND][key]]\n    //     }\n    //   );\n    //   dataRange.push(arr)\n    // }\n    // .slice()\n    // console.log(data)\n    // console.log(JSON.stringify(data))\n    // console.log(JSON.stringify(data.slice(4,254)))\n\n\n    return data;\n  }\n\n  futureData2(keywords, result) {\n    let data = []; // let dataRange = []\n\n    for (let keyword in keywords) {\n      let index = 0;\n      let k_w = keywords[keyword];\n      let arr = Object.keys(result[keywords[keyword] + \"F\"][keywords[keyword]]).map(function (key) {\n        // return [Date.UTC(key.substring(0,4), key.substring(5,7), key.substring(8,10)), result[keywords[keyword] + \"F\"][keywords[keyword]][key]]\n        return [index++, Date.UTC(key.substring(0, 4), key.substring(5, 7), key.substring(8, 10)), result[keywords[keyword] + \"F\"][MA_Day_5 + k_w][key], result[keywords[keyword] + \"F\"][LOWER_BAND + k_w][key], result[keywords[keyword] + \"F\"][UPPER_BAND + k_w][key]];\n      });\n      data.push(arr);\n    } // for (let keyword in keywords) {  \n    //   let arr = Object.keys(result[keywords[keyword] + \"F\"][LOWER_BAND]).map(\n    //     function(key){\n    //       return [Date.UTC(key.substring(0,4), key.substring(5,7), key.substring(8,10)), result[keywords[keyword] + \"F\"][LOWER_BAND][key], result[keywords[keyword] + \"F\"][UPPER_BAND][key]]\n    //     }\n    //   );\n    //   dataRange.push(arr)\n    // }\n    // console.log(data)\n    // console.log(JSON.stringify(data.slice(4,52)))\n    // console.log(JSON.stringify(data))\n\n\n    return data;\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/marcin/workspace/react/flask-react-app/client/src/App.js"],"names":["React","Component","Header","Input","Plot","Row","Col","Login","Table","Chart","Test_Plot_Dates","appConfig","dimensions","ranges","ranges_dates","MA_Day_5","LOWER_BAND","UPPER_BAND","App","constructor","props","handleSearch2","url","fetch","then","response","json","data","console","log","setState","title","fetchCallback","displayResults","fetchData2","keywords","selected_state_name","selected_time_frame","state","repos","username","authenticated","region_state","futureData","dataRanges","futureDataRanges","rankRates","growthRates","options","x_label","y_label","componentDidMount","method","headers","body","JSON","stringify","time_frame","res","result","that","dataMapping2","futureData2","getGrowthTableData","projected_growth_result","render","length","toLoginCallback","arr","Object","keys","map","key","keyword","index","k_w","slice","Date","UTC","substring","push"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,MAAP,MAAmB,qBAAnB;AACA,OAAOC,KAAP,MAAkB,oBAAlB;AACA,OAAOC,IAAP,MAAkB,oBAAlB;AACA,SAASC,GAAT,EAAaC,GAAb,QAAwB,iBAAxB;AACA,OAAOC,KAAP,MAAkB,oBAAlB;AACA,OAAOC,KAAP,MAAkB,oBAAlB;AACA,OAAOC,KAAP,MAAkB,oBAAlB,C,CACA;;AACA,OAAOC,eAAP,MAA4B,mBAA5B;AACA,OAAO,sCAAP;AACA,SAASC,SAAT,QAA0B,aAA1B;AACA,OAAO,mBAAP,C,CAGA;AACA;AACA;;AACA,IAAIC,UAAU,GAAGD,SAAS,CAACC,UAA3B;AACA,IAAIC,MAAM,GAAGF,SAAS,CAACG,YAAvB,C,CAEA;AACA;AACA;;AAEA,MAAMC,QAAQ,GAAG,eAAjB;AACA,MAAMC,UAAU,GAAG,iBAAnB;AACA,MAAMC,UAAU,GAAG,iBAAnB;;AAIA,MAAMC,GAAN,SAAkBlB,KAAK,CAACC,SAAxB,CAAkC;AAE9BkB,EAAAA,WAAW,CAACC,KAAD,EAAO;AAChB,UAAMA,KAAN;;AADgB,SAmDlBC,aAnDkB,GAmDF,MAAM;AAClB,UAAIC,GAAG,GAAG,aAAV;AACAC,MAAAA,KAAK,CAACD,GAAD,CAAL,CACAE,IADA,CACKC,QAAQ,IAAIA,QAAQ,CAACC,IAAT,EADjB,EACkCF,IADlC,CACwCG,IAAD,IAAU;AACjDC,QAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ;AACAD,QAAAA,OAAO,CAACC,GAAR,CAAYF,IAAZ;AACI,aAAKG,QAAL,CAAc;AACdC,UAAAA,KAAK,EAAE;AADO,SAAd;AAGH,OAPD;AAQH,KA7DiB;;AAAA,SAgElBC,aAhEkB,GAgEDL,IAAD,IAAU;AAEtB;AAEA;AACA;AACA;AACA;AACJ;AAEI,WAAKG,QAAL,CAAc;AACVG,QAAAA,cAAc,EAAE;AADN,OAAd;AAIA,WAAKC,UAAL,CAAgBP,IAAI,CAACQ,QAArB,EAA+BR,IAAI,CAACS,mBAApC,EAAyDT,IAAI,CAACU,mBAA9D,EAdsB,CAetB;AACA;AACA;AAIH,KArFiB;;AAEhB,SAAKC,KAAL,GAAa;AACXC,MAAAA,KAAK,EAAE,EADI;AAEXR,MAAAA,KAAK,EAAE,QAFI;AAGXS,MAAAA,QAAQ,EAAE,MAHC;AAIXL,MAAAA,QAAQ,EAAE,EAJC;AAKXM,MAAAA,aAAa,EAAE,IALJ;AAMXR,MAAAA,cAAc,EAAE,KANL;AAOXS,MAAAA,YAAY,EAAE,IAPH;AAQXf,MAAAA,IAAI,EAAE,EARK;AASXgB,MAAAA,UAAU,EAAE,EATD;AAUXN,MAAAA,mBAAmB,EAAE,WAVV;AAWXO,MAAAA,UAAU,EAAE,EAXD;AAYXC,MAAAA,gBAAgB,EAAE,EAZP;AAaXC,MAAAA,SAAS,EAAE,EAbA;AAcXC,MAAAA,WAAW,EAAE,EAdF;AAeXC,MAAAA,OAAO,EAAE;AACPjB,QAAAA,KAAK,EAAE,iBADA;AAEPkB,QAAAA,OAAO,EAAE,MAFF;AAGPC,QAAAA,OAAO,EAAE,qBAHF;AAIPtC,QAAAA,UAAU,EAAEA;AAJL;AAfE,KAAb,CAFgB,CAyBlB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACC;;AAEDuC,EAAAA,iBAAiB,GAAE,CACf;AACH;;AAsCDjB,EAAAA,UAAU,CAACC,QAAD,EAAWG,KAAX,EAAkBD,mBAAlB,EAAsC;AAE5C;AACA,QAAIf,GAAG,GAAG,MAAV;AAEAC,IAAAA,KAAK,CAACD,GAAD,EAAM;AACT8B,MAAAA,MAAM,EAAE,MADC;AAETC,MAAAA,OAAO,EAAE;AACP,wBAAgB;AADT,OAFA;AAKTC,MAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AACnBrB,QAAAA,QAAQ,EAAEA,QADS;AACCO,QAAAA,YAAY,EAAEJ,KADf;AACsBmB,QAAAA,UAAU,EAAEpB;AADlC,OAAf;AALG,KAAN,CAAL,CAQGb,IARH,CAQQkC,GAAG,IAAIA,GAAG,CAAChC,IAAJ,EARf,EASOF,IATP,CAUSmC,MAAD,IAAY;AAEhB;AACA;AACA,UAAIC,IAAI,GAAG,IAAX;AAEAA,MAAAA,IAAI,CAAC9B,QAAL,CAAc;AACZH,QAAAA,IAAI,EAAE,KAAKkC,YAAL,CAAkB1B,QAAlB,EAA4BwB,MAA5B,CADM;AAEZhB,QAAAA,UAAU,EAAE,KAAKmB,WAAL,CAAiB3B,QAAjB,EAA2BwB,MAA3B,CAFA;AAGd;AACA;AACExB,QAAAA,QAAQ,EAAEA,QALE;AAMZF,QAAAA,cAAc,EAAE,IANJ;AAOZS,QAAAA,YAAY,EAAEJ,KAPF;AAQZD,QAAAA,mBAAmB,EAAEA,mBART;AASZJ,QAAAA,cAAc,EAAE,IATJ;AAUd;AACEc,QAAAA,WAAW,EAAE,KAAKgB,kBAAL,CAAwBJ,MAAM,CAACK,uBAA/B;AAXD,OAAd;AAaK,KA7BT;AA+BD,GA7H2B,CA+HlC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEIC,EAAAA,MAAM,GAAG;AAEL,QAAI,KAAK3B,KAAL,CAAWG,aAAf,EAA8B;AAC9B,aACI;AAAK,QAAA,SAAS,EAAC,cAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACC,KAAKH,KAAL,CAAWL,cAAX,GAED;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,MAAD;AAAQ,QAAA,QAAQ,EAAE,KAAKK,KAAL,CAAWE,QAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,EAGE,oBAAC,KAAD;AAAO,QAAA,kBAAkB,EAAE,KAAKR,aAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAHF,EAKE;AAAK,QAAA,SAAS,EAAC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACA,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,GAAD;AAAK,QAAA,EAAE,EAAE,CAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,KAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CADF,CADJ,EAOI,oBAAC,GAAD;AAAK,QAAA,EAAE,EAAE,CAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAEE,oBAAC,eAAD;AAAiB,QAAA,OAAO,EAAE,KAAKM,KAAL,CAAWU,OAArC;AAA8C,QAAA,IAAI,EAAE,KAAKV,KAAL,CAAWX,IAA/D;AAAqE,QAAA,UAAU,EAAE,KAAKW,KAAL,CAAWK,UAA5F;AAAwG,QAAA,gBAAgB,EAAE,KAAKL,KAAL,CAAWK,UAAX,CAAsBuB,MAAhJ;AAAwJ,QAAA,QAAQ,EAAE,KAAK5B,KAAL,CAAWH,QAA7K;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFF,CADF,CAPJ,CADA,CALF,EAqBE;AAAK,QAAA,SAAS,EAAC,QAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,GAAD;AAAK,QAAA,EAAE,EAAE,CAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAM,QAAA,SAAS,EAAC,QAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAyB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAAzB,CADF,CADF,EAME,oBAAC,GAAD;AAAK,QAAA,EAAE,EAAE,CAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAM,QAAA,SAAS,EAAC,QAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAyB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BAAzB,CADF,EAEE,oBAAC,KAAD;AAAO,QAAA,SAAS,EAAE,KAAKG,KAAL,CAAWS,WAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFF,CANF,CADF,CArBF,CAFC,GAwCD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,MAAD;AAAQ,QAAA,QAAQ,EAAE,KAAKT,KAAL,CAAWE,QAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,EAEE,oBAAC,KAAD;AAAO,QAAA,kBAAkB,EAAE,KAAKR,aAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFF,EAIE;AAAK,QAAA,SAAS,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAJF,CAzCA,CADJ;AAqDC,KAtDD,MAsDM;AACN,aACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,KAAD;AAAO,QAAA,iBAAiB,EAAE,KAAKmC,eAA/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,CADA;AAIC;AACJ,GAzM6B,CA4M9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGEJ,EAAAA,kBAAkB,CAACpC,IAAD,EAAM;AAEtB,QAAI0B,OAAO,GAAG,CAAC,2DAAD,EAA8D,0DAA9D,CAAd;AAGA,QAAIe,GAAG,GAAGC,MAAM,CAACC,IAAP,CAAY3C,IAAI,CAAC,SAAD,CAAhB,EAA6B4C,GAA7B,CACR,UAASC,GAAT,EAAa;AACX,aAAO,CAAC7C,IAAI,CAAC,SAAD,CAAJ,CAAgB6C,GAAhB,CAAD,EAAuB7C,IAAI,CAAC0B,OAAO,CAAC,CAAD,CAAR,CAAJ,CAAiBmB,GAAjB,CAAvB,EAA8C7C,IAAI,CAAC0B,OAAO,CAAC,CAAD,CAAR,CAAJ,CAAiBmB,GAAjB,CAA9C,CAAP;AACD,KAHO,CAAV;AAMA,QAAIb,MAAM,GAAG;AACXhC,MAAAA,IAAI,EAAEyC,GADK;AAEXf,MAAAA,OAAO,EAAEA;AAFE,KAAb;AAKAzB,IAAAA,OAAO,CAACC,GAAR,CAAY8B,MAAZ;AAEA,WAAOA,MAAP;AACD,GAlQ2B,CAoQ9B;AAEA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;;;AAGEE,EAAAA,YAAY,CAAC1B,QAAD,EAAWwB,MAAX,EAAkB;AAC5B,QAAIhC,IAAI,GAAG,EAAX,CAD4B,CAE5B;AAEA;AACA;;AAEA,SAAK,IAAI8C,OAAT,IAAoBtC,QAApB,EAA8B;AAC1B;AACA;AACA,UAAIuC,KAAK,GAAG,CAAZ;AACA,UAAIC,GAAG,GAAGxC,QAAQ,CAACsC,OAAD,CAAlB;AACA,UAAIL,GAAG,GAAGC,MAAM,CAACC,IAAP,CAAYX,MAAM,CAACgB,GAAD,CAAN,CAAY5D,QAAQ,GAAC4D,GAArB,CAAZ,EAAuCC,KAAvC,CAA6C,CAA7C,EAA+C,GAA/C,EAAoDL,GAApD,CACV,UAASC,GAAT,EAAa;AACX;AACA,eAAO,CAACE,KAAK,EAAN,EAAUG,IAAI,CAACC,GAAL,CAASN,GAAG,CAACO,SAAJ,CAAc,CAAd,EAAgB,CAAhB,CAAT,EAA6BP,GAAG,CAACO,SAAJ,CAAc,CAAd,EAAgB,CAAhB,CAA7B,EAAiDP,GAAG,CAACO,SAAJ,CAAc,CAAd,EAAgB,EAAhB,CAAjD,CAAV,EAAiFpB,MAAM,CAACgB,GAAD,CAAN,CAAY5D,QAAQ,GAAC4D,GAArB,EAA0BH,GAA1B,CAAjF,EAAiHb,MAAM,CAACgB,GAAD,CAAN,CAAY3D,UAAU,GAAC2D,GAAvB,EAA4BH,GAA5B,CAAjH,EAAmJb,MAAM,CAACgB,GAAD,CAAN,CAAY1D,UAAU,GAAC0D,GAAvB,EAA4BH,GAA5B,CAAnJ,CAAP;AACD,OAJS,CAAV;AAMF7C,MAAAA,IAAI,CAACqD,IAAL,CAAUZ,GAAV;AACD,KAnB2B,CAqB5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACJ;AACI;AACA;AACA;;;AAEA,WAAOzC,IAAP;AACD;;AAGDmC,EAAAA,WAAW,CAAC3B,QAAD,EAAWwB,MAAX,EAAkB;AAE3B,QAAIhC,IAAI,GAAG,EAAX,CAF2B,CAG3B;;AAEA,SAAK,IAAI8C,OAAT,IAAoBtC,QAApB,EAA8B;AAC5B,UAAIuC,KAAK,GAAG,CAAZ;AACA,UAAIC,GAAG,GAAGxC,QAAQ,CAACsC,OAAD,CAAlB;AACA,UAAIL,GAAG,GAAGC,MAAM,CAACC,IAAP,CAAYX,MAAM,CAACxB,QAAQ,CAACsC,OAAD,CAAR,GAAoB,GAArB,CAAN,CAAgCtC,QAAQ,CAACsC,OAAD,CAAxC,CAAZ,EAAgEF,GAAhE,CACR,UAASC,GAAT,EAAa;AACX;AACA,eAAO,CAACE,KAAK,EAAN,EAAUG,IAAI,CAACC,GAAL,CAASN,GAAG,CAACO,SAAJ,CAAc,CAAd,EAAgB,CAAhB,CAAT,EAA6BP,GAAG,CAACO,SAAJ,CAAc,CAAd,EAAgB,CAAhB,CAA7B,EAAiDP,GAAG,CAACO,SAAJ,CAAc,CAAd,EAAgB,EAAhB,CAAjD,CAAV,EAAiFpB,MAAM,CAACxB,QAAQ,CAACsC,OAAD,CAAR,GAAoB,GAArB,CAAN,CAAgC1D,QAAQ,GAAC4D,GAAzC,EAA8CH,GAA9C,CAAjF,EAAqIb,MAAM,CAACxB,QAAQ,CAACsC,OAAD,CAAR,GAAoB,GAArB,CAAN,CAAgCzD,UAAU,GAAC2D,GAA3C,EAAgDH,GAAhD,CAArI,EAA2Lb,MAAM,CAACxB,QAAQ,CAACsC,OAAD,CAAR,GAAoB,GAArB,CAAN,CAAgCxD,UAAU,GAAC0D,GAA3C,EAAgDH,GAAhD,CAA3L,CAAP;AACD,OAJO,CAAV;AAMA7C,MAAAA,IAAI,CAACqD,IAAL,CAAUZ,GAAV;AACD,KAf0B,CAiB3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;;;AAEA,WAAOzC,IAAP;AACD;;AA7V2B;;AAiWhC,eAAeT,GAAf","sourcesContent":["import React, { Component } from 'react';\nimport Header from \"./components/Header\"\nimport Input from './components/Input'\nimport Plot  from './components/Plot2'\nimport { Row,Col } from 'react-bootstrap';\nimport Login from './components/Login';\nimport Table from './components/Table';\nimport Chart from './components/Chart';\n// import Test_Plot from './Test_Plot';\nimport Test_Plot_Dates from './Test_Plot_Dates';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport { appConfig } from './config.js';\nimport './styles/plot.css'\n\n\n// function calculateMean(array) {\n//   return (array.reduce((acc, c) => acc + c[1], 0)/array.length).toFixed(2)\n// }\nlet dimensions = appConfig.dimensions;\nlet ranges = appConfig.ranges_dates;\n\n// const MA_Day_5 = \"5 Day MA\";\n// const LOWER_BAND = \"Lower Band\";\n// const UPPER_BAND = \"Upper Band\";\n\nconst MA_Day_5 = \"5 Day MA for \";\nconst LOWER_BAND = \"Lower Band for \";\nconst UPPER_BAND = \"Upper Band for \";\n\n\n\nclass App extends React.Component {\n  \n    constructor(props){\n      super(props);\n      this.state = {\n        repos: [],\n        title: \"before\",\n        username: \"user\",\n        keywords: [],\n        authenticated: true,\n        displayResults: false,\n        region_state: \"US\",\n        data: [],\n        futureData: [],\n        selected_time_frame: \"today 5-y\",\n        dataRanges: [],\n        futureDataRanges: [],\n        rankRates: [],\n        growthRates: [],\n        options: {\n          title: \"Trends Forecast\",\n          x_label: \"Date\",\n          y_label: \"Search interest (%)\",\n          dimensions: dimensions,\n        },\n      };\n\n    //   this.state = {\n    //     username: \"user\",\n    //     keywords: [],\n    //     authenticated: true,\n    //     displayResults: false,\n    //     region_state: \"US\",\n    //     data: [],\n    //     futureData: [],\n    //     selected_time_frame: \"today 5-y\",\n    //     dataRanges: [],\n    //     futureDataRanges: [],\n    //     rankRates: [],\n    //     growthRates: [],\n    //     options: {\n    //       title: \"Trends Forecast\",\n    //       x_label: \"Date\",\n    //       y_label: \"Search interest (%)\",\n    //       dimensions: dimensions,\n    //     },\n    //   };\n    }\n\n    componentDidMount(){\n        // this.handleSearch2();\n    }\n\n    handleSearch2 = () => {\n        let url = '/users/ping';\n        fetch(url).\n        then(response => response.json()).then((data) => {\n        console.log(\"this data\")  \n        console.log(data);\n            this.setState({\n            title: \"after\"\n            });\n        });\n    };\n\n\n    fetchCallback = (data) => {\n\n        // console.log(data.keywords)\n\n        // this.handleSearch3();\n        // this.setState({\n        //     displayResults: true,\n        // });\n    // this.fetchData2(data.keywords, data.selected_state_name, data.selected_time_frame)\n\n        this.setState({\n            displayResults: false,\n        });\n  \n        this.fetchData2(data.keywords, data.selected_state_name, data.selected_time_frame)\n        // this.setState({\n        //     displayResults: true,\n        // });\n  \n\n\n    }\n\n    fetchData2(keywords, state, selected_time_frame){\n\n        // let url = appConfig.KEYWORDS_NEW;\n        let url = \"/new\"\n        \n        fetch(url, {\n          method: 'POST',\n          headers: {\n            'Content-type': 'application/json',\n          },\n          body: JSON.stringify({\n            keywords: keywords, region_state: state, time_frame: selected_time_frame\n          }),\n        }).then(res => res.json())\n              .then(\n                (result) => {\n    \n            // console.log(\"$$$\")        \n            // console.log(result)\n            var that = this;\n    \n            that.setState({\n              data: this.dataMapping2(keywords, result),\n              futureData: this.futureData2(keywords, result),\n            //   dataRanges: this.dataMapping2(keywords, result)[1],\n            //   futureDataRanges: this.futureData2(keywords, result)[1],\n              keywords: keywords,\n              displayResults: true,\n              region_state: state,\n              selected_time_frame: selected_time_frame,\n              displayResults: true,\n            //   rankRates: this.getRateTableData(result.rateranker),\n              growthRates: this.getGrowthTableData(result.projected_growth_result)\n            });\n                })\n          \n      }\n    \n//     handleSearch = (user) =>{\n//       let url = 'https://api.github.com/users/'+user+'/repos';\n//    fetch(url).\n//     then(response => response.json()).then((repos) => {\n//         console.log(repos);\n//         console.log(repos.length);\n//         this.setState({\n//           repos: repos\n//         });\n//       });\n//     };\n    \n    render() {\n\n        if (this.state.authenticated) {\n        return (\n            <div className=\"main_results\">\n            {this.state.displayResults ? (\n            \n            <div>\n              <Header username={this.state.username} />\n\n              <Input callbackFromParent={this.fetchCallback}/>\n\n              <div className=\"results_div\">\n              <Row> \n                  <Col sm={5}>\n                    <div>\n                      <Chart />\n                      {/* <Chart callbackFromApp={this.mapCallback}/> */}\n                    </div>\n                  </Col>\n                  <Col sm={7}>\n                    <div> \n                      {/* <Test_Plot_Dates options={this.state.options} number_of_series={5}/> */}\n                      <Test_Plot_Dates options={this.state.options} data={this.state.data} futureData={this.state.futureData} number_of_series={this.state.futureData.length} keywords={this.state.keywords} />\n                    </div>\n                  </Col>\n              </Row> \n              </div>\n              <div className=\"tables\">\n                <Row>\n                  <Col sm={6}>\n                    <span className=\"center\"><h3>Growth Rate</h3></span>\n                    {/* <Table /> */}\n                    {/* <Table tableData={this.state.rankRates} /> */}\n                  </Col>\n                  <Col sm={6}>\n                    <span className=\"center\"><h3>Projected growth</h3></span>\n                    <Table tableData={this.state.growthRates}  />\n                    {/* <Table /> */}\n                  </Col>\n                </Row>\n              </div>\n\n            </div>  ) : (\n            \n            <div>\n              <Header username={this.state.username} />\n              <Input callbackFromParent={this.fetchCallback}/>\n\n              <div className=\"intro\">\n              </div>\n            </div>\n            )\n          }\n            </div>\n            );\n        } else{\n        return (\n        <div>\n            <Login callbackFromLogin={this.toLoginCallback}/>\n        </div>);      \n        }\n    }\n    \n\n    // getRankRates(){\n    //     fetch(appConfig.GROWTH_RANKER_URL, {\n    //       method: 'POST',\n    //       headers: {\n    //         'Content-type': 'application/json',\n    //       },\n    //       body: JSON.stringify({\n    //         keywords: this.state.keywords\n    //       }),\n    //     }).then(res => res.json())\n    //       .then(\n    //       (result) => {\n    //         return this.getRateTableData(result)\n    //       },\n    //       )\n    //   }\n    \n    //   getGrowthRates(){\n    //     fetch(appConfig.GROWTH_RANKER_URL, {\n    //       method: 'POST',\n    //       headers: {\n    //         'Content-type': 'application/json',\n    //       },\n    //       body: JSON.stringify({\n    //         keywords: this.state.keywords\n    //       }),\n    //     }).then(res => res.json())\n    //       .then(\n    //       (result) => {\n    //         return this.getGrowthRates(result)\n    //       },\n    //       )\n    //   }\n\n\n      getGrowthTableData(data){\n\n        let headers = [\"Projected growth in 5 weeks for US (for all keywords) [%]\", \"Projected growth in 5 weeks for US (for one keyword) [%]\"]\n        \n        \n        let arr = Object.keys(data[\"Keyword\"]).map(\n          function(key){\n            return [data[\"Keyword\"][key], data[headers[0]][key], data[headers[1]][key]]\n          }\n        );\n    \n        let result = {\n          data: arr,\n          headers: headers\n        }\n\n        console.log(result)\n    \n        return result;\n      }\n    \n    //   getRateTableData(data){\n    \n    //     let headers = [\"Growth_Rate_0_1\", \"Growth_Rate_0_2\", \"Growth_Rate_0_3\", \"Growth_Rate_1_2\", \"Growth_Rate_2_3\"]\n    \n    //     let arr = Object.keys(data[\"Keyword\"]).map(\n    //       function(key){\n    //         return [data[\"Keyword\"][key], data[headers[0]][key], data[headers[1]][key], data[headers[2]][key], data[headers[3]][key], data[headers[4]][key]]\n    //       }\n    //     );\n    \n    //     let result = {\n    //       data: arr,\n    //       headers: headers\n    //     }\n    \n    //     return result;\n    //   }\n\n\n      dataMapping2(keywords, result){\n        let data = []\n        // let dataRange = []\n    \n        // console.log(\"ss\")\n        // console.log(result)\n    \n        for (let keyword in keywords) {  \n            // console.log(\"!!\" + keyword)\n            // console.log(result[keywords[keyword]][MA_Day_5])\n            let index = 0;\n            let k_w = keywords[keyword]\n            let arr = Object.keys(result[k_w][MA_Day_5+k_w]).slice(4,260).map(\n            function(key){\n              // return [Date.UTC(key.substring(0,4), key.substring(5,7), key.substring(8,10)), result[keywords[keyword]][MA_Day_5][key]]\n              return [index++, Date.UTC(key.substring(0,4), key.substring(5,7), key.substring(8,10)), result[k_w][MA_Day_5+k_w][key], result[k_w][LOWER_BAND+k_w][key], result[k_w][UPPER_BAND+k_w][key]]\n            }\n          );\n          data.push(arr)\n        }\n    \n        // for (let keyword in keywords) {  \n        //   let arr = Object.keys(result[keywords[keyword]][LOWER_BAND]).slice(4,260).map(\n        //     function(key){\n        //       return [Date.UTC(key.substring(0,4), key.substring(5,7), key.substring(8,10)), result[keywords[keyword]][LOWER_BAND][key], result[keywords[keyword]][UPPER_BAND][key]]\n        //     }\n        //   );\n        //   dataRange.push(arr)\n        // }\n    // .slice()\n        // console.log(data)\n        // console.log(JSON.stringify(data))\n        // console.log(JSON.stringify(data.slice(4,254)))\n    \n        return data;\n      }\n    \n    \n      futureData2(keywords, result){\n    \n        let data = []\n        // let dataRange = []\n    \n        for (let keyword in keywords) {  \n          let index = 0;\n          let k_w = keywords[keyword]\n          let arr = Object.keys(result[keywords[keyword] + \"F\"][keywords[keyword]]).map(\n            function(key){\n              // return [Date.UTC(key.substring(0,4), key.substring(5,7), key.substring(8,10)), result[keywords[keyword] + \"F\"][keywords[keyword]][key]]\n              return [index++, Date.UTC(key.substring(0,4), key.substring(5,7), key.substring(8,10)), result[keywords[keyword] + \"F\"][MA_Day_5+k_w][key], result[keywords[keyword] + \"F\"][LOWER_BAND+k_w][key], result[keywords[keyword] + \"F\"][UPPER_BAND+k_w][key]]\n            }\n          );\n          data.push(arr)\n        }\n    \n        // for (let keyword in keywords) {  \n        //   let arr = Object.keys(result[keywords[keyword] + \"F\"][LOWER_BAND]).map(\n        //     function(key){\n        //       return [Date.UTC(key.substring(0,4), key.substring(5,7), key.substring(8,10)), result[keywords[keyword] + \"F\"][LOWER_BAND][key], result[keywords[keyword] + \"F\"][UPPER_BAND][key]]\n        //     }\n        //   );\n        //   dataRange.push(arr)\n        // }\n    \n        // console.log(data)\n    \n        // console.log(JSON.stringify(data.slice(4,52)))\n        // console.log(JSON.stringify(data))\n    \n        return data;\n      }\n  }\n  \n  \n  export default App;\n"]},"metadata":{},"sourceType":"module"}